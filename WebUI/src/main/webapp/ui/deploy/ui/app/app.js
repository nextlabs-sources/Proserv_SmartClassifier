var mainApp=angular.module("mainApp",["ui.router","ui.bootstrap","ui.numeric","uiSwitch","ngSanitize","pascalprecht.translate","templates-main","ngAnimate","ngMessages","ngMaterial","ui.utils.masks","chart.js"]);mainApp.config(["$stateProvider","$urlRouterProvider","$translateProvider","$mdThemingProvider","ChartJsProvider",function(a,b,c,d,e){d.theme("default").primaryPalette("blue"),e.setOptions({colors:["#5CB85C","#F0AD4E","#D9534F","#222222","#FDB45C","#949FB1","#4D5360"]}),b.otherwise("/Overview"),b.rule(function(a,b){var c=b.path(),d="/"===c[c.length-1];if(d){var e=c.substr(0,c.length-1);return e}}),a.state("overview",{url:"/Overview",templateUrl:"ui/app/Overview/overview.html",controller:"overviewController"}).state("rules",{url:"/Rules",templateUrl:"ui/app/Rules/ruleList.html",controller:"ruleListController"}).state("ruleDetails",{url:"/Rules/{id}",templateUrl:"ui/app/Rules/ruleDetails.html",controller:"ruleDetailsController"}).state("scservices",{url:"/Services/{type}",templateUrl:"ui/app/SCServices/serviceList.html",controller:"servicesListController"}).state("serviceDetails",{url:"/Services/{type}/{id}",templateUrl:"ui/app/SCServices/serviceDetails.html",controller:"serviceDetailsController"}).state("indexDatabaseQuery",{url:"/IndexDatabaseQuery/{id}",templateUrl:"ui/app/IndexDatabaseQuery/indexDatabaseQuery.html",controller:"indexDatabaseQueryController"}).state("indexDatabaseQueryTemp",{url:"/IndexDatabaseQuery",templateUrl:"ui/app/IndexDatabaseQuery/indexDatabaseQuery.html",controller:"indexDatabaseQueryController"}).state("indexDatabaseQueryResult",{url:"/IndexDatabaseQueryResult/{id}",templateUrl:"ui/app/IndexDatabaseQuery/indexDatabaseQueryResult.html",controller:"indexDatabaseQueryResultController"}).state("Plugins",{url:"/Settings/Plugins",templateUrl:"ui/app/Settings/Plugins/pluginList.html",controller:"pluginListController"}).state("PluginDetails",{url:"/Settings/Plugins/{id}",templateUrl:"ui/app/Settings/Plugins/pluginDetails.html",controller:"pluginDetailsController"}).state("JMS",{url:"/Settings/MessagingService",templateUrl:"ui/app/Settings/JMS/jmsList.html",controller:"jmsListController"}).state("JMSDetails",{url:"/Settings/MessagingService/{id}",templateUrl:"ui/app/Settings/JMS/jmsDetails.html",controller:"jmsDetailsController"}).state("login",{url:"/Login",templateUrl:"ui/app/Login/login.html",controller:"loginController"}).state("ExecutionWindow",{url:"/Settings/ExecutionWindow",templateUrl:"ui/app/Settings/ExecutionWindow/executionWindowList.html",controller:"executionWindowListController"}).state("ExecutionWindowDetails",{url:"/Settings/ExecutionWindow/{id}",templateUrl:"ui/app/Settings/ExecutionWindow/executionWindowDetails.html",controller:"executionWindowDetailsController"}).state("License",{url:"/Settings/License",templateUrl:"ui/app/Settings/License/license.html",controller:"licenseController"}).state("GeneralSettings",{url:"/Settings/GeneralSettings",templateUrl:"ui/app/Settings/General/generalSettings.html",controller:"generalSettingsController"}),c.useStaticFilesLoader({prefix:"ui/app/i18n/",suffix:".json"}),c.preferredLanguage("en"),c.useSanitizeValueStrategy("sanitize")}]),mainApp.filter("num",function(){return function(a){return parseInt(a,10)}}),mainApp.controller("loginController",["$scope","$state","loggerService","$location",function(a,b,c,d){a.doLogin=function(a,c){b.go("overview")},c.getLogger().info("Logging"),c.getLogger().info(d.path())}]),mainApp.controller("indexDatabaseQueryController",["$scope","$location","loggerService","$filter","$stateParams","generalService","ruleService","$state","sharedService","indexDatabaseQueryService","configService",function(a,b,c,d,e,f,g,h,i,j,k){a.$parent.isDetailsPage=!1,a.ruleID=e.id,a.sortOrders=k.getSortOrders(),a.sortOrder=a.sortOrders[0],a.ruleID&&0!==a.ruleID.length||(a.ruleID="custom"),g.getMatchingConditions(function(b){a.matchingConditions=b}),g.getMetaDataMatchingConditions(function(b){a.metaDataMatchingConditions=b}),g.getDataProviders(function(b){a.dataProviders=b}),a.dataSections=g.getDataSections(),g.getMetaDataList(function(b){a.metaDataList=b}),a.addCriteriaGroup=function(){a.query||(a.query={}),a.query.criteria||(a.query.criteria=[]),a.query.criteria.push({criterias:[{displayOrder:1,dataSection:"A",fieldName:"",matchingCondition:"CONTAINS",value:null}],displayOrder:a.query.criteria.length+1,operator:"AND"})},a.addCriteria=function(a){a.criterias||(a.criterias=[]),a.criterias.push({displayOrder:a.criterias.length+1,dataSection:"A",fieldName:"",matchingCondition:"CONTAINS",value:null})},i.data.query?a.query=angular.copy(i.data.query):"custom"===a.ruleID?(a.query={},a.addCriteriaGroup()):g.getRule(a.ruleID,function(b){a.query={criteria:b.data.criteriaGroups,directories:b.data.directories}}),a.removeCriteriaGroup=function(b){a.query.criteria.splice(b,1)},a.removeCriteria=function(b,c,d){b.criterias.splice(d,1),0===b.criterias.length&&a.query.criteria.splice(c,1)},a.removeCriteriaGroup=function(b){a.query.criteria.splice(b,1)},a.changeDataSection=function(a,b){a.dataSection=b,a.matchingCondition="CONTAINS",a.value=null,"M"!==b&&(a.fieldName="",a.field="")},a.changeMatchingCondition=function(a,b){a.matchingCondition=b.code,a.value=null},a.changeMetaMatchingCondition=function(b,c){b.matchingCondition=c.code,b.value=null,b.fieldName&&b.fieldName.lastIndexOf("_")>-1?(b.fieldName=b.fieldName.slice(0,b.fieldName.lastIndexOf("_")),a.isStringCriteria(b)?b.fieldName=b.field+"_t":a.isDateCriteria(b)?(b.date=new Date,b.dateOpened=!1,b.openDate=function(){b.dateOpened=!0},b.value=b.date.getTime(),b.fieldName=b.field+"_tdt"):a.isNumberCriteria(b)?b.fieldName=b.field+"_ti":b.fieldName=b.field+"_t"):a.isDateCriteria(b)&&(b.date=new Date,b.value=b.date.getTime(),b.dateOpened=!1,b.openDate=function(){b.dateOpened=!0})},a.updateDateCriteria=function(a){a.date&&(a.value=a.date.getTime())},a.updateMetaField=function(b){b.field?a.isStringCriteria(b)?b.fieldName=b.field+"_t":a.isDateCriteria(b)?b.fieldName=b.field+"_tdt":a.isNumberCriteria(b)?b.fieldName=b.field+"_ti":b.fieldName=b.field+"_t":b.fieldName=null},a.changeMetadataField=function(a,b){a.fieldName=b.value,a.fieldCode=b.code,a.fieldName.lastIndexOf("_")>-1?a.field=a.fieldName.slice(0,a.fieldName.lastIndexOf("_")):a.field=a.fieldName;var c=a.fieldCode.length;"_tdt"===a.fieldCode.slice(c-4,c)?(a.matchingCondition="DATE_EQUALS",a.date=new Date,a.dateOpened=!1,a.openDate=function(){a.dateOpened=!0},a.value=a.date.getTime()):"_ti"===a.fieldCode.slice(c-3,c)?(a.matchingCondition="NUM_EQUALS",a.value=null):(a.matchingCondition="CONTAINS",a.value=null)},a.resetMetaMatchingCondition=function(a){a.fieldCode=void 0},a.hideMetaMatchingCondition=function(a,b){if(!a.fieldCode)return!1;var c=a.fieldCode.length;if(f.stringStartWith(b,"DATE")){if("_tdt"===a.fieldCode.slice(c-4,c))return!1}else if(f.stringStartWith(b,"NUM")){if("_ti"===a.fieldCode.slice(c-3,c))return!1}else if("_t"===a.fieldCode.slice(c-2,c))return!1;return!0},a.isMetaData=function(a,b){return"M"===a.dataSection?(a.isMetaData=!0,a.fieldName&&!a.field&&(a.fieldDisplayName?(a.field=a.fieldDisplayName,a.fieldCode=a.fieldName,a.fieldName=a.fieldDisplayName):a.field=a.fieldName,a.field.lastIndexOf("_")>-1&&(a.field=a.field.slice(0,a.field.lastIndexOf("_")))),!0):(a.isMetaData=!1,!1)},a.hasMetaData=function(a){for(var b=0;b<a.criterias.length;b++)if(a.criterias[b].isMetaData)return!0;return!1},a.isDateCriteria=function(a){var b=f.stringStartWith(a.matchingCondition,"DATE");return b&&(a.openDate=function(){a.dateOpened=!0},a.date||(a.dateOpened=!1,a.value?a.date=new Date(Number(a.value)):(a.date=new Date,a.value=a.date.getTime()))),b},a.isNumberCriteria=function(a){return f.stringStartWith(a.matchingCondition,"NUM")},a.isStringCriteria=function(a){return"NOT"===a.matchingCondition||"NOT_CONTAINS"===a.matchingCondition||"MUST_CONTAINS"===a.matchingCondition||"CONTAINS"===a.matchingCondition},a.checkDataProvider=function(a,b){return c.getLogger().debug(a+" "+b),a&&b?f.stringStartWith(a,b):!1},a.changeDataProvider=function(a,b){a.value=b.suggestion},a.backToRule=function(){h.go("ruleDetails",{id:a.ruleID})},a.scrollTo=function(a){b.hash(a),$anchorScroll(),currentTarget=a},a.querySolr=function(b){if(b.$invalid){b.$setDirty();for(var c in b)"$"!=c[0]&&(b[c].$touched=!0,b[c].$dirty=!0)}else angular.forEach(a.query.directories,function(b,c){angular.forEach(b.criterias,function(b,c){a.checkDirectory(b)})}),i.data.query=angular.copy(a.query),a.executeSolrQuery()},a.addDirectory=function(){a.query||(a.query={}),a.query.directories&&0!==a.query.directories.length?a.query.directories[0].criterias&&0!=a.query.directories[0].criterias.length?a.query.directories[0].criterias.push({dataSection:"D",matchingCondition:"CONTAINS",value:""}):a.query.directories[0].criterias=[{dataSection:"D",matchingCondition:"CONTAINS",value:""}]:a.query.directories=[{operator:"AND",criterias:[{dataSection:"D",matchingCondition:"CONTAINS",value:""}]}]},a.checkDirectory=function(a){a.value&&"\\*"!=a.value.slice(a.value.length-2,a.value.length)&&"\\"!=a.value.slice(a.value.length-1,a.value.length)&&"/"!=a.value.slice(a.value.length-1,a.value.length)&&"/*"!=a.value.slice(a.value.length-2,a.value.length)&&(a.value+="\\")},a.removeDirectory=function(b){a.query.directories[0].criterias.splice(b,1)},a.executeSolrQuery=function(){a.resultList=[],a.total=0,a.resultPageNumber=1,j.getSortFields(function(b){a.sortByFields=b.data,c.getLogger().debug(b),c.getLogger().debug("Sort fields from service "+a.sortByFields),a.sortByFields||(a.sortByFields=[{code:"modifiedOn",value:"Last Updated"}]),a.sortBy=a.sortByFields[0];var d=[{field:a.sortBy.code,order:a.sortOrder.value}];j.executeQuery(a.query,a.resultPageNumber,d,function(b){a.resultList=b.data,a.total=b.totalNoOfRecords,i.data.solrResult=angular.copy(a.resultList),i.data.solrTotal=angular.copy(a.total),i.data.sortByFields=angular.copy(a.sortByFields),h.go("indexDatabaseQueryResult",{id:a.ruleID})})})}}]),mainApp.controller("indexDatabaseQueryResultController",["$scope","loggerService","$filter","$stateParams","generalService","configService","$state","sharedService","indexDatabaseQueryService",function(a,b,c,d,e,f,g,h,i){a.$parent.isDetailsPage=!0,a.ruleID=d.id,a.sortOrders=f.getSortOrders(),a.sortOrder=a.sortOrders[0],a.executeSolrQuery=function(c){a.resultList=[],a.total=0,a.resultPageNumber=1,a.totalSortFields=0,c?i.executeQuery(a.query,a.resultPageNumber,c,function(c){a.resultList=c.data,a.total=c.totalNoOfRecords,b.getLogger().debug(JSON.stringify(c))}):i.getSortFields(function(c){a.sortByFields=c.data,b.getLogger().debug(JSON.stringify(c.data)),b.getLogger().info("Sort fields from service "+a.sortByFields),a.sortByFields||(a.sortByFields=[{code:"modifiedOn",value:"Last Updated"}]),a.sortBy=a.sortByFields[0];var d=[{field:a.sortBy.code,order:a.sortOrder.value}];i.executeQuery(a.query,a.resultPageNumber,d,function(c){a.resultList=c.data,a.total=c.totalNoOfRecords,b.getLogger().debug(c)})})},h.data.query?(a.query=angular.copy(h.data.query),h.data.solrResult&&h.data.solrTotal&&h.data.sortByFields?(a.resultList=angular.copy(h.data.solrResult),a.total=angular.copy(h.data.solrTotal),a.sortByFields=angular.copy(h.data.sortByFields),a.sortBy=a.sortByFields[0],a.resultPageNumber=1):a.executeSolrQuery()):g.go("indexDatabaseQuery",{id:"custom"}),a.sortByField=function(b){var c=[{field:b.code,order:a.sortOrder.value}];a.sortBy=b,a.executeSolrQuery(c)},a.sortByOrder=function(b){var c=[{field:a.sortBy.code,order:b.value}];a.sortOrder=b,a.executeSolrQuery(c)},a.loadMore=function(){var c=[{field:a.sortBy.code,order:a.sortOrder.value}];a.resultPageNumber++,i.executeQuery(a.query,a.resultPageNumber,c,function(c){a.resultList=a.resultList.concat(c.data),a.total=c.totalNoOfRecords,b.getLogger().debug(JSON.stringify(c))})},a.editQuery=function(){g.go("indexDatabaseQuery",{id:a.ruleID})},a.isDateCriteria=function(a){var b=e.stringStartWith(a.matchingCondition,"DATE");return b}}]),mainApp.factory("indexDatabaseQueryService",["networkService","loggerService","configService","$filter","statusCodeService",function(a,b,c,d,e){var f=c.configObject.defaultIDBResultPageSize,g=function(d,g,h,i){b.getLogger().info("Executing index database query");var j={criteria:d.criteria,directories:d.directories,sortFields:h,pageNo:g,pageSize:f};b.getLogger().debug("The request date is = "+JSON.stringify(j)),a.post(c.getUrl("solr.query"),j,function(a){e.list("solr query",i,a)})},h=function(b){a.get(c.getUrl("solr.sortFields"),function(a){e.list("idq sort fields",b,a)})};return{executeQuery:g,getSortFields:h}}]),mainApp.controller("overviewController",["$scope","$state","loggerService","$stateParams","$filter","dialogService","summaryService",function(a,b,c,d,e,f,g){a.$parent.isDetailsPage=!1,a.serviceLabels=[e("translate")("dashboard.service.healthy"),"",e("translate")("dashboard.service.critical")],a.processLabels=[e("translate")("dashboard.process.success"),e("translate")("dashboard.process.fail")],a.getDashboardInfo=function(){g.getSummary("document",function(b){a.documentSummary=b.data,a.loadLicenseInfo()}),g.getSummary("watcher",function(b){a.watcherSummary=b.data,a.criticalHeartbeat=b.criticalHeartBeat,a.loadWatcherInfo()}),g.getSummary("extractor",function(b){a.extractorSummary=b.data,a.loadExtractorInfo()}),g.getSummary("ruleEngine",function(b){a.ruleEngineSummary=b.data,a.loadRuleEngineInfo()})},a.getDashboardInfo(),a.refresh=function(){a.getDashboardInfo()},a.loadLicenseInfo=function(){for(var b=0;b<a.documentSummary.length;b++)if(a.documentSummary[b].value){if("Data size"==a.documentSummary[b].code){a.dataSize=Number(a.documentSummary[b].value);continue}if("Used size"==a.documentSummary[b].code){a.usedSize=Number(a.documentSummary[b].value)/1024/1024/1024,a.usedSize=a.usedSize.toFixed(2);continue}if("Total document"==a.documentSummary[b].code){a.totalDocs=Number(a.documentSummary[b].value);continue}if("Success extraction"==a.documentSummary[b].code){a.successExtraction=Number(a.documentSummary[b].value);continue}if("Fail extraction"==a.documentSummary[b].code){a.failExtraction=Number(a.documentSummary[b].value);continue}}if(a.licenseFound=!0,void 0!=a.dataSize&&void 0!=a.usedSize||(a.licenseFound=!1),a.processDetailsFound=!0,void 0==a.totalDocs||0==a.totalDocs||void 0==a.successExtraction||void 0==a.failExtraction)a.processDetailsFound=!1;else{var c=Math.round(a.successExtraction/(a.successExtraction+a.failExtraction)*100),d=100-c;a.processDetails=[c,d]}},a.loadWatcherInfo=function(){a.watcherInfo={};for(var b=0;b<a.watcherSummary.length;b++)if(a.watcherSummary[b].value){if("Total"==a.watcherSummary[b].code){a.watcherInfo.total=a.watcherSummary[b].value;continue}if("Healthy"==a.watcherSummary[b].code){a.watcherInfo.healthy=a.watcherSummary[b].value;continue}if("Warning"==a.watcherSummary[b].code){a.watcherInfo.warning=a.watcherSummary[b].value;continue}if("Critical"==a.watcherSummary[b].code){a.watcherInfo.critical=a.watcherSummary[b].value;continue}}else a.watcherInfo.missing=!0;0==a.watcherInfo.total&&(a.watcherInfo.missing=!0),a.watcherData=[Number(a.watcherInfo.healthy),0,Number(a.watcherInfo.critical)]},a.loadExtractorInfo=function(){a.extractorInfo={};for(var b=0;b<a.extractorSummary.length;b++)if(a.extractorSummary[b].value){if("Total"==a.extractorSummary[b].code){a.extractorInfo.total=a.extractorSummary[b].value;continue}if("Healthy"==a.extractorSummary[b].code){a.extractorInfo.healthy=a.extractorSummary[b].value;continue}if("Warning"==a.extractorSummary[b].code){a.extractorInfo.warning=a.extractorSummary[b].value;continue}if("Critical"==a.extractorSummary[b].code){a.extractorInfo.critical=a.extractorSummary[b].value;continue}}else a.extractorInfo.missing=!0;0==a.extractorInfo.total&&(a.extractorInfo.missing=!0),a.extractorData=[Number(a.extractorInfo.healthy),0,Number(a.extractorInfo.critical)]},a.loadRuleEngineInfo=function(){a.ruleEngineInfo={};for(var b=0;b<a.ruleEngineSummary.length;b++)if(a.ruleEngineSummary[b].value){if("Total"==a.ruleEngineSummary[b].code){a.ruleEngineInfo.total=a.ruleEngineSummary[b].value;continue}if("Healthy"==a.ruleEngineSummary[b].code){a.ruleEngineInfo.healthy=a.ruleEngineSummary[b].value;continue}if("Warning"==a.ruleEngineSummary[b].code){a.ruleEngineInfo.warning=a.ruleEngineSummary[b].value;continue}if("Critical"==a.ruleEngineSummary[b].code){a.ruleEngineInfo.critical=a.ruleEngineSummary[b].value;continue}}else a.ruleEngineInfo.missing=!0;0==a.ruleEngineInfo.total&&(a.ruleEngineInfo.missing=!0),a.ruleEngineData=[Number(a.ruleEngineInfo.healthy),0,Number(a.ruleEngineInfo.critical)]},a.goToService=function(a){b.go("scservices",{type:a})},a.getUsedSizeStyle=function(){return a.usedSize/a.dataSize<.5?"":a.usedSize/a.dataSize<.75?"":a.usedSize/a.dataSize<=1?"":a.usedSize/a.dataSize>1?"danger":void 0},a.getRemaining=function(){return(a.dataSize-a.usedSize).toFixed(2)}}]),mainApp.controller("ruleDetailsController",["$scope","$location","loggerService","$filter","$stateParams","sharedService","generalService","dialogService","ruleService","collectionService","$state","$anchorScroll",function(a,b,c,d,e,f,g,h,i,j,k,l){a.$parent.isDetailsPage=!0,a.ruleID=e.id,c.getLogger().info("Rule id is "+a.ruleID),a.validity={},a.validFromPopUp={opened:!1},a.expiringOnPopUp={opened:!1},a.validFromOpen=function(){a.validFromPopUp.opened=!0},a.expiringOnOpen=function(){a.expiringOnPopUp.opened=!0},a.dayOfTheWeek=g.getDayOfTheWeek(),a.dayOfTheMonth=g.getDayOfTheMonth(),i.getMatchingConditions(function(b){a.matchingConditions=b}),i.getMetaDataMatchingConditions(function(b){a.metaDataMatchingConditions=b}),i.getDataProviders(function(b){a.dataProviders=b}),a.dataSections=i.getDataSections(),i.getMetaDataList(function(b){a.metaDataList=b}),a.actionCollapse={},a.selectActionDropDownBtn=d("translate")("rule.editor.select.action.dropdown"),a.reloadRule=function(){i.getRule(a.ruleID,function(b){a.rule=b.data,c.getLogger().debug(a.rule),a.validity.validFrom=new Date(a.rule.effectiveFrom),0===a.rule.effectiveUntil?(a.validity.expiringOnOption="never",a.validity.expiringOn=new Date):(a.validity.expiringOnOption="specific",a.validity.expiringOn=new Date(a.rule.effectiveUntil)),a.loadSchedule(),a.rule.criteriaGroups&&a.loadCriterias(),a.copyResetObjects(),a.rule?a.detailsFound=!0:a.detailsFound=!1,c.getLogger().debug(a.rule)})},a.copyResetObjects=function(){a.resetRule=angular.copy(a.rule),a.resetWeeklySchedules=angular.copy(a.weeklySchedules),a.resetDailySchedules=angular.copy(a.dailySchedules),a.resetMonthlySchedules=angular.copy(a.monthlySchedules),a.resetValidity=angular.copy(a.validity)},a.loadSchedule=function(){if(a.rule.executionFrequency){var b=new Date;if(b.setHours(a.rule.executionFrequency.time.slice(0,2)),b.setMinutes(a.rule.executionFrequency.time.slice(2,4)),"D"===a.rule.scheduleType)a.dailySchedules=[{time:b}],a.initializeWeeklyTimeSlot(),a.initializeMonthlyTimeSlot();else if("W"===a.rule.scheduleType){var d={sun:!1,mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1};angular.forEach(a.rule.executionFrequency.dayOfWeek,function(a,b){c.getLogger().debug(g.getDayOfTheWeekMap()[a]),d[g.getDayOfTheWeekMap()[a]]=!0}),a.weeklySchedules=[{time:b,days:d}],a.initializeDailyTimeSlot(),a.initializeMonthlyTimeSlot()}else{for(var d={},e=1;31>e;e++)d[e]=!1;d.L=!1,angular.forEach(a.rule.executionFrequency.dayOfMonth,function(a,b){d[a]=!0}),a.monthlySchedules=[{time:b,days:d}],a.initializeDailyTimeSlot(),a.initializeWeeklyTimeSlot()}}else a.rule.executionFrequency={},a.initializeDailyTimeSlot(),a.initializeWeeklyTimeSlot(),a.initializeMonthlyTimeSlot()},a.initializeWeeklyTimeSlot=function(){var b=new Date;b.setHours(0),b.setMinutes(0),a.weeklySchedules=[{days:{sun:!1,mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1},time:b}]},a.initializeDailyTimeSlot=function(){var b=new Date;b.setHours(0),b.setMinutes(0),a.dailySchedules=[{time:b}]},a.initializeMonthlyTimeSlot=function(){var b=new Date;b.setHours(0),b.setMinutes(0);for(var c={},d=1;31>d;d++)c[d+""]=!1;c.L=!1,a.monthlySchedules=[{days:c,time:b}]},a.selectAll=function(a){angular.forEach(a.days,function(b,c){"L"!=c&&(a.days[c]=!0)})},a.clearAll=function(a){angular.forEach(a.days,function(b,c){a.days[c]=!1})},a.getDayOfMonthString=function(a){var b="",c=[];if(angular.forEach(a,function(a,e){if(a)"L"===e?c.push(d("translate")("L")):c.push(e);else{if(c.length>2)b+=c[0]+"-"+c[c.length-1]+", ";else for(var f=0;f<c.length;f++)b+=c[f]+", ";c.length=0}}),c.length>0)if(c.length>2)b+=c[0]+"-"+c[c.length-1]+", ";else for(var e=0;e<c.length;e++)b+=c[e]+", ";return b=0===b.length?d("translate")("month.days.alt"):b.slice(0,b.length-2)},a.getScheduleAsText=function(){var b="";return"D"===a.rule.scheduleType?(b+=d("translate")("daily.label")+" "+d("translate")("at.label")+" ",angular.forEach(a.dailySchedules,function(c,e){0!=e&&(b+=" "+d("translate")("and.label")+" "),b+=a.parseTimeToString(c.time,!0)})):"W"===a.rule.scheduleType?(b+=d("translate")("weekly.label")+" "+d("translate")("on.label")+" ",angular.forEach(a.weeklySchedules,function(c,e){0!=e&&(b+=" "+d("translate")("and.label")+" ");var f=!1,g="";angular.forEach(c.days,function(a,b){a&&(f=!0,g+=d("translate")(b+".label")+" ")}),b+=f?"("+g.slice(0,g.length-1)+")":"<"+d("translate")("week.days.alt")+">",b+=" "+d("translate")("at.label")+" ",b+=a.parseTimeToString(c.time,!0)})):(b+=d("translate")("monthly.label")+" "+d("translate")("on.label")+" ",angular.forEach(a.monthlySchedules,function(c,e){0!=e&&(b+=" "+d("translate")("and.label")+" ");var f=a.getDayOfMonthString(c.days);b+=0===f.length?"<"+d("translate")("month.days.alt")+">":"("+f+")",b+=" "+d("translate")("at.label")+" ",b+=a.parseTimeToString(c.time,!0)})),b},a.monthlyScheduleChange=function(a,b,d){if(c.getLogger().debug(b+" "+d),"L"==b&&d)for(var e=1;31>e;e++)a.days[e]=!1;"L"!=b&&d&&(a.days.L=!1)},"create"===a.ruleID?(a.rule={name:null,scheduleType:"D",displayOrder:1},a.validity.validFrom=new Date,a.validity.expiringOn=new Date,a.validity.expiringOnOption="never",a.initializeWeeklyTimeSlot(),a.initializeDailyTimeSlot(),a.initializeMonthlyTimeSlot(),a.detailsFound=!0,a.resetrule=angular.copy(a.rule),a.isCreated=!0):(a.reloadRule(),a.isCreated=!1),a.loadCriterias=function(){},a.addCriteriaGroup=function(){a.rule.criteriaGroups||(a.rule.criteriaGroups=[]),a.rule.criteriaGroups.push({criterias:[{displayOrder:1,dataSection:"A",fieldName:"",matchingCondition:"CONTAINS",value:null,newCri:!0}],displayOrder:a.rule.criteriaGroups.length+1,operator:"AND"})},a.addCriteria=function(a){a.criterias||(a.criterias=[]),a.criterias.push({displayOrder:a.criterias.length+1,dataSection:"A",fieldName:"",matchingCondition:"CONTAINS",value:null,newCri:!0})},a.removeCriteriaGroup=function(b){a.rule.criteriaGroups.splice(b,1)},a.removeCriteria=function(b,c,d){b.criterias.splice(d,1),0===b.criterias.length&&a.rule.criteriaGroups.splice(c,1)},a.removeCriteriaGroup=function(b){a.rule.criteriaGroups.splice(b,1)},a.changeDataSection=function(a,b){a.dataSection=b,a.matchingCondition="CONTAINS",a.value=null,"M"!==b&&(a.fieldName="",a.field="")},a.changeMatchingCondition=function(a,b){a.matchingCondition=b.code,a.value=null},a.changeMetaMatchingCondition=function(b,c){b.matchingCondition=c.code,b.value=null,b.fieldName&&b.fieldName.lastIndexOf("_")>-1?(b.fieldName=b.fieldName.slice(0,b.fieldName.lastIndexOf("_")),a.isStringCriteria(b)?b.fieldName=b.field+"_t":a.isDateCriteria(b)?(b.fieldName=b.field+"_tdt",b.date=new Date,b.value=b.date.getTime(),b.dateOpened=!1,b.openDate=function(){b.dateOpened=!0}):a.isNumberCriteria(b)?b.fieldName=b.field+"_ti":b.fieldName=b.field+"_t"):a.isDateCriteria(b)&&(b.date=new Date,b.value=b.date.getTime(),b.dateOpened=!1,b.openDate=function(){b.dateOpened=!0})},a.updateDateCriteria=function(a){a.date&&(a.value=a.date.getTime())},a.updateMetaField=function(b){b.field?a.isStringCriteria(b)?b.fieldName=b.field+"_t":a.isDateCriteria(b)?b.fieldName=b.field+"_tdt":a.isNumberCriteria(b)?b.fieldName=b.field+"_ti":b.fieldName=b.field+"_t":b.fieldName=null},a.changeMetadataField=function(a,b){a.fieldName=b.value,a.fieldCode=b.code,a.fieldName.lastIndexOf("_")>-1?a.field=a.fieldName.slice(0,a.fieldName.lastIndexOf("_")):a.field=a.fieldName;var c=a.fieldCode.length;"_tdt"===a.fieldCode.slice(c-4,c)?(a.matchingCondition="DATE_EQUALS",a.date=new Date,a.value=a.date.getTime(),a.dateOpened=!1,a.openDate=function(){a.dateOpened=!0}):"_ti"===a.fieldCode.slice(c-3,c)?(a.matchingCondition="NUM_EQUALS",a.value=null):(a.matchingCondition="CONTAINS",a.value=null)},a.resetMetaMatchingCondition=function(a){a.fieldCode=void 0},a.hideMetaMatchingCondition=function(a,b){if(!a.fieldCode)return!1;var c=a.fieldCode.length;if(g.stringStartWith(b,"DATE")){if("_tdt"===a.fieldCode.slice(c-4,c))return!1}else if(g.stringStartWith(b,"NUM")){if("_ti"===a.fieldCode.slice(c-3,c))return!1}else if("_t"===a.fieldCode.slice(c-2,c))return!1;return!0},a.isMetaData=function(b,c){var d;return"M"===b.dataSection?(b.isMetaData=!0,b.fieldName&&!b.field&&(b.fieldDisplayName?(b.field=b.fieldDisplayName,b.fieldCode=b.fieldName,b.fieldName=b.fieldDisplayName):b.field=b.fieldName,b.field.lastIndexOf("_")>-1&&(b.field=b.field.slice(0,b.field.lastIndexOf("_")))),d=!0):(b.isMetaData=!1,d=!1),b.metaLoaded||b.newCri||(b.metaLoaded=!0,a.resetRule=angular.copy(a.rule)),d},a.hasMetaData=function(a){for(var b=0;b<a.criterias.length;b++)if(a.criterias[b].isMetaData)return!0;return!1},a.isDateCriteria=function(b){var c=g.stringStartWith(b.matchingCondition,"DATE");return c&&(b.date||(b.dateOpened=!1,b.openDate=function(){b.dateOpened=!0},b.value?b.date=new Date(Number(b.value)):(b.date=new Date,b.value=b.date.getTime()))),b.dateLoaded||b.newCri||(b.dateLoaded=!0,a.resetRule=angular.copy(a.rule)),c},a.isNumberCriteria=function(a){return g.stringStartWith(a.matchingCondition,"NUM")},a.isStringCriteria=function(a){return"NOT"===a.matchingCondition||"NOT_CONTAINS"===a.matchingCondition||"MUST_CONTAINS"===a.matchingCondition||"CONTAINS"===a.matchingCondition},a.checkDataProvider=function(a,b){return c.getLogger().debug(a+" "+b),a&&b?g.stringStartWith(a,b):!1},a.changeDataProvider=function(a,b){a.value=b.suggestion},a.backToRuleList=function(b){a.dataPristine()?k.go("rules"):h.confirm({msg:d("translate")("details.back.confirm"),ok:function(){k.go("rules")}})},a.dataPristine=function(){return angular.equals(a.rule,a.resetRule)&&angular.equals(a.weeklySchedules,a.resetWeeklySchedules)&&angular.equals(a.dailySchedules,a.resetDailySchedules)&&angular.equals(a.monthlySchedules,a.resetMonthlySchedules)?!!angular.equals(a.validity,a.resetValidity):!1},a.scrollTo=function(a){b.hash(a),l(),currentTarget=a},a.discardRuleChanges=function(b){c.getLogger().info("Discarding changes"),a.rule=angular.copy(a.resetRule),a.weeklySchedules=angular.copy(a.resetWeeklySchedules),a.dailySchedules=angular.copy(a.resetDailySchedules),a.monthlySchedules=angular.copy(a.resetMonthlySchedules),a.validity=angular.copy(a.resetValidity),b.$setPristine()},a.execute=function(){i.executeRule(a.rule.id,function(a){})},a.preview=function(){a.rule.criteriaGroups||(a.rule.criteriaGroups=[]),a.rule.directories||(a.rule.directories=[{}]),f.data.query={criteria:angular.copy(a.rule.criteriaGroups),directories:angular.copy(a.rule.directories)},k.go("indexDatabaseQuery",{id:a.rule.id})},a.saveRuleChanges=function(b){if(b.$invalid){b.$setDirty();for(var e in b)"$"!=e[0]&&(b[e].$touched=!0,b[e].$dirty=!0)}else{if(0!=a.validity.expiringOn&&a.validity.validFrom.getTime()>a.validity.expiringOn.getTime())return void h.notify({type:"sc-dialog-error",msg:d("translate")("rule.editor.invalid.expiration.validation"),ok:function(){}});if(a.rule.effectiveFrom=a.validity.validFrom.getTime(),"specific"===a.validity.expiringOnOption?a.rule.effectiveUntil=a.validity.expiringOn.getTime():a.rule.effectiveUntil=0,c.getLogger().debug(a.rule.scheduleType),"D"===a.rule.scheduleType){var f={time:a.parseTimeToString(a.dailySchedules[0].time,!1)};a.rule.executionFrequency=f}else if("W"===a.rule.scheduleType){var j=[];angular.forEach(a.weeklySchedules[0].days,function(a,b){a===!0&&(j.push(g.getDayOfTheWeekMap()[b]),c.getLogger().debug(b))});var f={dayOfWeek:j,time:a.parseTimeToString(a.weeklySchedules[0].time,!1)};a.rule.executionFrequency=f}else{var j=[];angular.forEach(a.monthlySchedules[0].days,function(a,b){a===!0&&j.push(b)});var f={dayOfMonth:j,time:a.parseTimeToString(a.monthlySchedules[0].time,!1)};a.rule.executionFrequency=f}angular.forEach(a.rule.directories,function(b,c){angular.forEach(b.criterias,function(b,c){a.checkDirectory(b)})}),a.isCreated?i.createRule(a.rule,function(a){k.go("rules")}):i.modifyRule(a.rule,function(b){a.copyResetObjects()}),b.$setPristine()}},a.loadRuleEngine=function(){a.ruleEngineList=[],a.totalRuleEngines=0,j.getCollection("RuleEngine",function(b){a.ruleEngineList=b.data,a.totalRuleEngines=b.totalNoOfRecords})},a.loadRuleEngine(),a.changeRuleEngine=function(b){a.rule.ruleEngine=b},a.checkBoolean=function(b){var d=!1;return"Boolean"===b.dataType&&(c.getLogger().debug(b),("string"==typeof b.values[0].value||b.values[0].value instanceof String)&&("true"===b.values[0].value?b.values[0].value=!0:b.values[0].value=!1),d=!0),b.paramLoaded||b.newParam||(b.paramLoaded=!0,a.resetRule=angular.copy(a.rule)),d},a.getActionPluginName=function(a){return a.name.replace(/_/g," ")},a.loadPlugins=function(){a.pluginList=[],a.totalPlugins=0,j.getCollection("ActionPlugin",function(b){a.pluginList=b.data,a.totalPlugins=b.totalNoOfRecords})},a.loadPlugins(),a.addAction=function(b){var c={actionPlugin:{id:b.id,name:b.name,params:b.params},toleranceLevel:"S",actionParams:[]};angular.forEach(b.params,function(a,b){var d={identifier:a.identifier,values:[],dataType:a.dataType,collections:a.collections,keyValue:a.keyValue,label:a.label,newParam:!0};a.collections?a.keyValue&&d.values.push({key:"",value:""}):a.keyValue?d.values.push({key:"",value:""}):("String"!=a.dataType&&"Character"!==a.dataType&&"Email"!==a.dataType||d.values.push({value:""}),"Number"!==a.dataType&&"Integer"!==a.dataType||d.values.push({value:0}),"Boolean"===a.dataType&&d.values.push({value:!0})),c.actionParams.push(d)}),a.rule.actions||(a.rule.actions=[]),a.rule.actions.push(c),a.actionCollapse[a.rule.actions.length-1]=!1,a.selectActionDropDownBtn=d("translate")("rule.editor.select.action.dropdown")},a.removeActionParamElement=function(a,b){a.values.splice(b,1)},a.addActionParamElement=function(a){a.values.push({key:"",value:""})},a.saveAction=function(b,d){var e=!0;for(var f in d)0===f.toString().lastIndexOf("actionParam-"+b,0)&&d[f].$invalid&&(c.getLogger().info("invalid field "+f),e=!1,d[f].$touched=!0,d[f].$dirty=!0);e&&(a.actionCollapse[b]=!0)},a.editAction=function(b){a.actionCollapse[b]=!1},a.removeAction=function(b){a.rule.actions.splice(b,1),a.actionCollapse={};for(var c=0;c<a.rule.actions.length;c++)a.actionCollapse[c]=!0},a.addDirectory=function(){a.rule.directories&&0!==a.rule.directories.length?a.rule.directories[0].criterias&&0!=a.rule.directories[0].criterias.length?a.rule.directories[0].criterias.push({dataSection:"D",matchingCondition:"CONTAINS",value:""}):a.rule.directories[0].criterias=[{dataSection:"D",matchingCondition:"CONTAINS",value:""}]:a.rule.directories=[{operator:"AND",criterias:[{dataSection:"D",matchingCondition:"CONTAINS",value:""}]}]},a.checkDirectory=function(a){a.value&&"\\*"!=a.value.slice(a.value.length-2,a.value.length)&&"\\"!=a.value.slice(a.value.length-1,a.value.length)&&"/"!=a.value.slice(a.value.length-1,a.value.length)&&"/*"!=a.value.slice(a.value.length-2,a.value.length)&&(a.value+="\\")},a.removeDirectory=function(b){a.rule.directories[0].criterias.splice(b,1)}}]),mainApp.controller("ruleListController",["$scope","$state","loggerService","$window","$filter","sharedService","autoCloseOptionService","ruleService","configService","dialogService",function(a,b,c,d,e,f,g,h,i,j){var k=i.configObject.defaultRulePageSize;a.$parent.isDetailsPage=!1,a.sortOrders=i.getSortOrders(),a.sortOrder=a.sortOrders[1],a.refreshRuleList=function(b){
a.ruleList=[],a.total=0,a.rulePageNumber=1,a.totalSortFields=0,b?h.getRuleList(a.rulePageNumber,b,function(b){a.ruleList=b.data,a.total=b.totalNoOfRecords,a.numberOfPage=a.total%k==0?a.total/k:a.total/k+1,c.getLogger().debug(b)}):h.getSortFields(function(b){a.sortByFields=b.data,c.getLogger().debug(b),a.sortByFields||(a.sortByFields=[{code:"modifiedOn",value:"Last Updated"}]),a.sortBy=a.sortByFields[0];var d=[{field:a.sortBy.code,order:a.sortOrder.value}];h.getRuleList(a.rulePageNumber,d,function(b){a.ruleList=b.data,a.total=b.totalNoOfRecords,a.numberOfPage=a.total%k==0?a.total/k:a.total/k+1,c.getLogger().debug(b)})})},a.refreshRuleList(),a.sortByField=function(b){var c=[{field:b.code,order:a.sortOrder.value}];a.sortBy=b,a.refreshRuleList(c)},a.sortByOrder=function(b){var c=[{field:a.sortBy.code,order:b.value}];a.sortOrder=b,a.refreshRuleList(c)},a.loadMore=function(){var b=[{field:a.sortBy.code,order:a.sortOrder.value}];a.rulePageNumber++,c.getLogger().info("Page number "+a.rulePageNumber),h.getRuleList(a.rulePageNumber,b,function(b){a.ruleList=a.ruleList.concat(b.data),a.total=b.totalNoOfRecords,a.numberOfPage=a.total%k==0?a.total/k:a.total/k+1,c.getLogger().debug(b)})},a.deleteRule=function(b,d){j.confirm({msg:e("translate")("rule.del.confirm")+": "+b.name+"?",ok:function(){h.deleteRule(b.id,b.modifiedOn,function(b){a.refreshRuleList(),c.getLogger().debug(b)})}}),d.stopPropagation()},a.preview=function(a){a.criteriaGroups||(a.criteriaGroups=[]),a.directories||(a.directories=[{}]),f.data.query={criteria:angular.copy(a.criteriaGroups),directories:angular.copy(a.directories)},b.go("indexDatabaseQuery",{id:a.id})},a.duplicateRule=function(b){b.name=b.name+" - Duplicate",b.enabled=!1,h.createRule(b,function(b){a.refreshRuleList()})},a.openRule=function(a){c.getLogger().info("Openning rule "+a.id),b.go("ruleDetails",{id:a.id})},a.createNewRule=function(){c.getLogger().info("Go to creating new rule"),b.go("ruleDetails",{id:"create"})};var l=[];a.closeAllOpenOption=function(){l.length>0&&(angular.forEach(l,function(a){c.getLogger().info("The Rule object is = "+JSON.stringify(a)),a.optionOpen&&(a.optionOpen=!1)}),l=[])},a.openOption=function(b,c,d){return angular.isDefined(c)?(b.optionOpen=c,void(c?(a.closeAllOpenOption(),g.close(),g.registerOpen(a,a.closeAllOpenOption),l.push(b)):l=[])):angular.isDefined(b.optionOpen)?b.optionOpen:!1},a.isOptionOpen=function(a){return a.optionOpen?a.optionOpen:!1}}]),mainApp.factory("ruleService",["networkService","loggerService","configService","$filter","statusCodeService","collectionService",function(a,b,c,d,e,f){var g=c.configObject.defaultRulePageSize,h=[],i=[],j=[],k=["D","N","H","C","F","A","M"],l=[],m=function(b){a.get(c.getUrl("rule.sortFields"),function(a){e.list("rule sort fields",b,a)})},n=function(a){l&&l.length>0&&a(l),f.getCollection("MetadataFieldName",function(b){a&&a(b.data),l=b.data})},o=function(d,f,h){b.getLogger().info("Get rule list with page number "+d+" and page size "+g);var i={sortFields:f,pageNo:d,pageSize:g};a.post(c.getUrl("rule.list"),i,function(a){e.list("rule",h,a)})},p=function(d,f){b.getLogger().info("Get rule with ID "+d),a.get(c.getUrl("rule.get")+d,function(a){e.get("rule",f,a)})},q=function(d,f){b.getLogger().info("Creating rule with details "+d);var g=d;a.post(c.getUrl("rule.add"),g,function(a){e.create("Rule",f,a)})},r=function(d,f){b.getLogger().info("Modifying rule  "+d.id);var g=d;a.put(c.getUrl("rule.modify"),g,function(a){e.modify("rule",f,a)})},s=function(d,f,g){b.getLogger().info("Deleting rule "+d),a.del(c.getUrl("rule.delete")+d+"/"+f,function(a){e.del("rule",g,a)})},t=function(d,f){b.getLogger().info("Executing rule "+d),a.post(c.getUrl("rule.execute")+d,null,function(a){e.execute("rule execution",f,a)})},u=function(a){h&&h.length>0&&a(h),f.getCollection("MatchingCondition",function(b){a&&a(b.data),h=b.data})},v=function(a){i&&i.length>0&&a(i),f.getCollection("MetaDataMatchingCondition",function(b){a&&a(b.data),i=b.data})},w=function(a){j&&j.length>0&&a(j),f.getCollection("DataProvider",function(b){a&&a(b.data),j=b.data})},x=function(){return k};return{getRuleList:o,getRule:p,modifyRule:r,getSortFields:m,deleteRule:s,getMatchingConditions:u,getMetaDataMatchingConditions:v,getDataProviders:w,getDataSections:x,createRule:q,getMetaDataList:n,executeRule:t}}]),mainApp.controller("extractorController",["$scope","loggerService","collectionService","scServicesService","$location","$anchorScroll","$filter",function(a,b,c,d,e,f,g){b.getLogger().info("Extractor id is "+a.serviceID),a.service.documentSizeLimits||(a.service.documentSizeLimits=[]),a.serviceTempObject.associatedExecutionWindowSetsMap={},angular.forEach(a.service.executionWindowSets,function(b,c){a.serviceTempObject.associatedExecutionWindowSetsMap[b.id]=!0}),a.service.configReloadInterval>=3600&&a.service.configReloadInterval%3600==0?(a.serviceTempObject.configReloadIntervalUnit="hour",a.serviceTempObject.configReloadIntervalTemp=a.service.configReloadInterval/3600):(a.serviceTempObject.configReloadIntervalUnit="min",a.serviceTempObject.configReloadIntervalTemp=a.service.configReloadInterval/60,a.serviceTempObject.configReloadIntervalTemp<5&&(a.serviceTempObject.configReloadIntervalTemp=5,a.service.configReloadInterval=300));var h="extractorInfo";a.scrollTo=function(a){b.getLogger().info("Scrolling to "+a),e.hash(a),f(),h=a},a.highlightGrammar=function(a){h=a},a.mapDocumentTypeAssocations=new Object,a.selectedExecutionWindowName=g("translate")("component.editor.dropdown.heading"),a.loadHeapMemoryList=function(){a.heapMemoryList=[128,256,384,512],b.getLogger().debug(a.heapMemoryList)},a.loadHeapMemoryList(),a.changeHeapMemory=function(b){a.service.minimumHeapMemory=b},a.addToExecutionWindowList=function(b){a.service.executionWindowSets||(a.service.executionWindowSets=[]),a.service.executionWindowSets.push(b),a.serviceTempObject.associatedExecutionWindowSetsMap[b.id]=!0,a.selectedExecutionWindowName=g("translate")("component.editor.dropdown.heading")},a.getExecutionWindowRowClass=function(a){return a%2==0?"sc-data-list-row-even":"sc-data-list-row-odd"},a.removeExecutionWindow=function(b){a.serviceTempObject.associatedExecutionWindowSetsMap[a.service.executionWindowSets[b].id]=!1,a.service.executionWindowSets.splice(b,1)},a.changeConfigReloadIntervalUnit=function(b,c){a.serviceTempObject.configReloadIntervalUnit=b,a.onConfigReloadIntervalEdit(c)},a.onConfigReloadIntervalEdit=function(b){"hour"==a.serviceTempObject.configReloadIntervalUnit?a.service.configReloadInterval=3600*b:a.service.configReloadInterval=60*b},a.loadDocumentTypes=function(){a.documentTypes=[],a.totalDocumentTypes=0,c.getCollection("DocumentType",function(b){a.documentTypes=b.data,a.totalDocumentTypes=b.totalNoOfRecords,a.updateDocumentSizeLimitsArray()})},a.loadDocumentTypes(),a.updateDocumentSizeLimitsArray=function(){if("undefined"!=typeof a.service.documentSizeLimits){for(var c=0;c<a.documentTypes.length;c++)if(!i(a.service.documentSizeLimits,a.documentTypes[c])){var d={documentExtractor:{extension:"doc",id:0x55f2a78974d03},maxFileSize:0};d.documentExtractor.extension=a.documentTypes[c].extension,d.documentExtractor.id=a.documentTypes[c].id,d.maxFileSize=0,a.service.documentSizeLimits.push(d)}}else{a.service.documentSizeLimits=[];for(var c=0;c<a.documentTypes.length;c++){var d={documentExtractor:{extension:"doc",id:0x55f2a78974d03},maxFileSize:0};d.documentExtractor.extension=a.documentTypes[c].extension,d.documentExtractor.id=a.documentTypes[c].id,d.maxFileSize=0,a.service.documentSizeLimits.push(d)}}a.resetService=angular.copy(a.service),b.getLogger().debug("The service.documentSizeLimits now become = "+JSON.stringify(a.service.documentSizeLimits))};var i=function(a,b){for(var c=0;c<a.length;c++)if(a[c].documentExtractor.id===b.id)return!0;return!1};a.updateResetObject=function(){a.$parent.setResetServiceTempObject(angular.copy(a.serviceTempObject)),b.getLogger().debug("Updating reset object "+JSON.stringify(a.$parent.resetServiceTempObject))},a.updateResetObject()}]),mainApp.controller("ruleEngineController",["$scope","loggerService","collectionService","scServicesService","$location","$anchorScroll","$filter",function(a,b,c,d,e,f,g){b.getLogger().info("Rule Engine id is "+a.serviceID),a.serviceTempObject.associatedExecutionWindowSetsMap={},angular.forEach(a.service.executionWindowSets,function(b,c){a.serviceTempObject.associatedExecutionWindowSetsMap[b.id]=!0}),a.service.configReloadInterval>=3600&&a.service.configReloadInterval%3600==0?(a.serviceTempObject.configReloadIntervalUnit="hour",a.serviceTempObject.configReloadIntervalTemp=a.service.configReloadInterval/3600):(a.serviceTempObject.configReloadIntervalUnit="min",a.serviceTempObject.configReloadIntervalTemp=a.service.configReloadInterval/60,a.serviceTempObject.configReloadIntervalTemp<5&&(a.serviceTempObject.configReloadIntervalTemp=5,a.service.configReloadInterval=300)),a.service.onDemandInterval>=60&&a.service.onDemandInterval%60==0?(a.serviceTempObject.onDemandIntervalUnit="min",a.serviceTempObject.onDemandIntervalTemp=a.service.onDemandInterval/60):(a.serviceTempObject.onDemandIntervalUnit="second",a.serviceTempObject.onDemandIntervalTemp=a.service.onDemandInterval),a.service.scheduledInterval>=60&&a.service.scheduledInterval%60==0?(a.serviceTempObject.scheduledIntervalUnit="min",a.serviceTempObject.scheduledIntervalTemp=a.service.scheduledInterval/60):(a.serviceTempObject.scheduledIntervalUnit="second",a.serviceTempObject.scheduledIntervalTemp=a.service.scheduledInterval);var h="ruleEngineInfo";a.scrollTo=function(a){b.getLogger().info("Scrolling to "+a),e.hash(a),f(),h=a},a.highlightGrammar=function(a){h=a},a.selectedExecutionWindowName=g("translate")("component.editor.dropdown.heading"),a.addToExecutionWindowList=function(b){a.service.executionWindowSets||(a.service.executionWindowSets=[]),a.service.executionWindowSets.push(b),a.serviceTempObject.associatedExecutionWindowSetsMap[b.id]=!0,a.selectedExecutionWindowName=g("translate")("component.editor.dropdown.heading")},a.getExecutionWindowRowClass=function(a){return a%2==0?"sc-data-list-row-even":"sc-data-list-row-odd"},a.removeExecutionWindow=function(b){a.serviceTempObject.associatedExecutionWindowSetsMap[a.service.executionWindowSets[b].id]=!1,a.service.executionWindowSets.splice(b,1)},a.changeConfigReloadIntervalUnit=function(b,c){a.serviceTempObject.configReloadIntervalUnit=b,a.onConfigReloadIntervalEdit(c)},a.onConfigReloadIntervalEdit=function(b){"hour"==a.serviceTempObject.configReloadIntervalUnit?a.service.configReloadInterval=3600*b:a.service.configReloadInterval=60*b},a.onDemandRuleIntervalEdit=function(b){"min"==a.serviceTempObject.onDemandIntervalUnit?a.service.onDemandInterval=60*b:a.service.onDemandInterval=b},a.onScheduledRuleIntervalEdit=function(b){"min"==a.serviceTempObject.scheduledIntervalUnit?a.service.scheduledInterval=60*b:a.service.scheduledInterval=b},a.changeOnDemandRuleIntervalUnit=function(b,c){a.serviceTempObject.onDemandIntervalUnit=b,a.onDemandRuleIntervalEdit(c)},a.changeScheduledRuleIntervalUnit=function(b,c){a.serviceTempObject.scheduledIntervalUnit=b,a.onScheduledRuleIntervalEdit(c)},a.updateResetObject=function(){a.$parent.setResetServiceTempObject(angular.copy(a.serviceTempObject)),b.getLogger().debug("Updating reset object "+JSON.stringify(a.$parent.resetServiceTempObject))},a.updateResetObject()}]),mainApp.controller("serviceDetailsController",["$scope","$state","$location","loggerService","$stateParams","$filter","sharedService","scServicesService","dialogService","collectionService","executionWindowService",function(a,b,c,d,e,f,g,h,i,j,k){a.$parent.isDetailsPage=!0,a.serviceTempObject={},a.resetServiceTempObject={},a.serviceType=e.type,a.serviceID=e.id,a.serviceController=a.serviceType+"Controller",a.mapExecutionWindowCollection=new Object,a.serviceController=a.serviceType+"Controller";d.getLogger().info("Service type is "+a.serviceType),d.getLogger().info("Service id is "+a.serviceID),a.reloadService=function(){d.getLogger().info("Cannot retrieve service from shared data. Making a request to retrieve the service"),h.getService(a.serviceType,a.serviceID,function(b){a.service=b.data,a.resetService=angular.copy(a.service),d.getLogger().debug(a.service),a.service?a.detailsFound=!0:a.detailsFound=!1})},a.reloadService(),a.backToServiceList=function(c){a.dataPristine()?b.go("scservices",{type:a.serviceType}):i.confirm({msg:f("translate")("details.back.confirm"),ok:function(){b.go("scservices",{type:a.serviceType})}})},a.dataPristine=function(){return angular.equals(a.service,a.resetService)?angular.equals(a.serviceTempObject,a.resetServiceTempObject)?!0:(d.getLogger().debug("serviceTempObject and resetServiceTempObject not equal"),!1):(d.getLogger().debug("service and resetService not equal"),!1)},a.getServiceController=function(){return a.serviceType+"Controller"},a.scrollTo=function(a){c.hash(a),$anchorScroll(),c.hash("resourceInfo",""),currentTarget=a},a.checkEmptyExecutionWindowList=function(){return a.executionWindowCollection?!(!a.service.executionWindowSets||a.service.executionWindowSets.length!==a.executionWindowCollection.length):!0},a.discardServiceChanges=function(b){d.getLogger().info("Discarding changes"),a.service=angular.copy(a.resetService),a.serviceTempObject=angular.copy(a.resetServiceTempObject),b.$setPristine()},a.saveServiceChanges=function(b){if(b.$invalid){b.$setDirty();for(var c in b)"$"!=c[0]&&(b[c].$touched=!0)}else d.getLogger().debug(a.service.name),h.modifyService(a.service,a.serviceType,function(b){a.resetService=angular.copy(a.service),a.resetServiceTempObject=angular.copy(a.serviceTempObject),d.getLogger().info(b.message)}),b.$setPristine()},a.loadJMSList=function(){a.jmsList=[],a.totalJMSProfiles=0,j.getCollection("JMSProfile",function(b){a.jmsList=b.data,a.totalJMSProfiles=b.totalNoOfRecords,d.getLogger().debug("JMS List"+a.jmsList)})},a.loadJMSList(),a.changeJMSProfile=function(b){a.service.JMSProfile=b},a.loadExecutionWindowCollection=function(){a.executionWindowCollection=[],a.totalExecutionWindows=0,j.getCollection("ExecutionWindowSet",function(b){a.executionWindowCollection=b.data,a.totalExecutionWindows=b.totalNoOfRecords})},a.returnScheduleString=function(a){return k.createScheduleString(a)},a.loadExecutionWindowCollection(),a.setResetServiceTempObject=function(b){a.resetServiceTempObject=b}}]),mainApp.factory("scServicesService",["networkService","loggerService","configService","$filter","statusCodeService",function(a,b,c,d,e){var f=c.configObject.defaultServicePageSize,g=function(){return[{label:d("translate")("services.sort.by.name"),field:"name"}]},h=function(d,g,h,i){b.getLogger().info("Get service list of type "+d+" with page number "+g+" and page size "+f);var j={sortFields:h,pageNo:g,pageSize:f};b.getLogger().info("Request data "+JSON.stringify(j)),b.getLogger().debug(c.getUrl(d+".list")),a.post(c.getUrl(d+".list"),j,function(a){e.list(d,i,a)})},i=function(d,f,g){b.getLogger().info("Get service of type "+d+" with ID "+f),b.getLogger().debug(c.getUrl(d+".get")+f),a.get(c.getUrl(d+".get")+f,function(a){e.get(d,g,a)})},j=function(d,f,g){b.getLogger().info("Modifying "+f+"  "+d.id),b.getLogger().debug(d.name);var h=d;a.put(c.getUrl(f+".modify"),h,function(a){e.modify(f,g,a)})};return{getServiceList:h,getService:i,modifyService:j,getSortFields:g}}]),mainApp.controller("servicesListController",["$scope","$state","loggerService","$window","$stateParams","$filter","sharedService","autoCloseOptionService","scServicesService","configService",function(a,b,c,d,e,f,g,h,i,j){var k=j.configObject.defaultServicePageSize;a.$parent.isDetailsPage=!1,a.serviceType=e.type,c.getLogger().info("Service type is "+a.serviceType),a.sortByFields=i.getSortFields(),a.sortOrders=j.getSortOrders(),a.sortOrder=a.sortOrders[0],a.sortBy=a.sortByFields[0];var l=[{field:a.sortBy.field,order:a.sortOrder.value}];"watcher"==a.serviceType?a.title=f("translate")("TAB.SCServices.Watchers"):"extractor"==a.serviceType?a.title=f("translate")("TAB.SCServices.Extractors"):a.title=f("translate")("TAB.SCServices.RuleEngine"),a.refreshServiceList=function(b){a.serviceList=[],a.paginator=[],a.total=0,a.servicePageNumber=1,i.getServiceList(a.serviceType,a.servicePageNumber,b,function(b){a.serviceList=b.data,a.total=b.totalNoOfRecords,a.numberOfPage=a.total%k==0?a.total/k:a.total/k+1,c.getLogger().debug(b)})},a.refreshServiceList(l),a.sortByField=function(b){var c=[{field:b.field,order:a.sortOrder.value}];a.sortBy=b,a.refreshServiceList(c)},a.sortByOrder=function(b){var c=[{field:a.sortBy.field,order:b.value}];a.sortOrder=b,a.refreshServiceList(c)},a.loadMore=function(){var b=[{field:a.sortBy.field,order:a.sortOrder.value}];a.servicePageNumber++,c.getLogger().debug(a.servicePageNumber),i.getServiceList(a.serviceType,a.servicePageNumber,b,function(b){a.serviceList=a.serviceList.concat(b.data),a.total=b.totalNoOfRecords,a.numberOfPage=a.total%k==0?a.total/k:a.total/k+1,c.getLogger().debug(b)})},a.goToPage=function(b){a.servicePageNumber=b,a.refreshServiceList()},a.nextPage=function(){a.servicePageNumber!=a.numberOfPage&&(a.servicePageNumber++,a.refreshServiceList())},a.previousPage=function(){1!=a.servicePageNumber&&(a.servicePageNumber--,a.refreshServiceList())},a.openService=function(d){c.getLogger().info("Openning "+a.serviceType+" "+d.name),g.data.serviceDetails=d,b.go("serviceDetails",{type:a.serviceType,id:d.id})},a.getServiceClass=function(a){return"sc-status-"+a.status};var m=[];a.closeAllOpenOption=function(){m.length>0&&(angular.forEach(m,function(a){c.getLogger().debug("The service object is = "+JSON.stringify(a)),a.optionOpen&&(a.optionOpen=!1)}),m=[])},a.openOption=function(b,c,d){return angular.isDefined(c)?(b.optionOpen=c,void(c?(a.closeAllOpenOption(),h.close(),h.registerOpen(a,a.closeAllOpenOption),m.push(b)):m=[])):angular.isDefined(b.optionOpen)?b.optionOpen:!1},a.isOptionOpen=function(a){return a.optionOpen?a.optionOpen:!1}}]),mainApp.controller("watcherController",["$scope","loggerService","scServicesService","$location","$anchorScroll","collectionService","generalService",function(a,b,c,d,e,f,g){b.getLogger().info("Watcher id is "+a.serviceID),a.service.configReloadInterval>=3600&&a.service.configReloadInterval%3600==0?(a.serviceTempObject.configReloadIntervalUnit="hour",a.serviceTempObject.configReloadIntervalTemp=a.service.configReloadInterval/3600):(a.serviceTempObject.configReloadIntervalUnit="min",a.serviceTempObject.configReloadIntervalTemp=a.service.configReloadInterval/60,a.serviceTempObject.configReloadIntervalTemp<5&&(a.serviceTempObject.configReloadIntervalTemp=5,a.service.configReloadInterval=300));var h="watcherInfo";a.scrollTo=function(a){b.getLogger().info("Scrolling to "+a),d.hash(a),e(),h=a},a.highlightGrammar=function(a){h=a},a.changeConfigReloadIntervalUnit=function(b,c){a.serviceTempObject.configReloadIntervalUnit=b,a.onConfigReloadIntervalEdit(c)},a.onConfigReloadIntervalEdit=function(b){"hour"==a.serviceTempObject.configReloadIntervalUnit?a.service.configReloadInterval=3600*b:a.service.configReloadInterval=60*b},a.loadDirectories=function(){a.serviceTempObject.inDirectories=[]},a.loadDocumentTypes=function(){a.documentTypes=[],a.totalDocumentTypes=0,f.getCollection("DocumentType",function(b){a.documentTypes=b.data,a.totalDocumentTypes=b.totalNoOfRecords,a.updateDocumentTypeAssociations()})},a.loadDocumentTypes(),a.updateDocumentTypeAssociations=function(){if("undefined"!=typeof a.service.documentTypeAssociations){for(var c=0;c<a.documentTypes.length;c++)if(!i(a.service.documentTypeAssociations,a.documentTypes[c])){var d={documentExtractor:{extension:"doc",id:0x55f2a78974d03},include:!1};d.documentExtractor.extension=a.documentTypes[c].extension,d.documentExtractor.id=a.documentTypes[c].id,d.include=!1,a.service.documentTypeAssociations.push(d)}}else{a.service.documentTypeAssociations=[];for(var c=0;c<a.documentTypes.length;c++){var d={documentExtractor:{extension:"doc",id:0x55f2a78974d03},include:!1};d.documentExtractor.extension=a.documentTypes[c].extension,d.documentExtractor.id=a.documentTypes[c].id,d.include=!1,a.service.documentTypeAssociations.push(d)}}b.getLogger().debug("The service.documentTypeAssociations now become = "+JSON.stringify(a.service.documentTypeAssociations))};var i=function(a,b){for(var c=0;c<a.length;c++)if(a[c].documentExtractor.id===b.id)return!0;return!1};a.checkExFolder=function(a,b){b.path&&0!==b.path.length||(b.path=a.path),a.path&&(g.isSubFolder(b.path,a.path)||(b.path=a.path))},a.addExcludeFolder=function(a){a.excludeRepositoryFolders||(a.excludeRepositoryFolders=[]),a.excludeRepositoryFolders.push({path:a.path})},a.removeExcludeFolder=function(a,b){b.excludeRepositoryFolders.splice(a,1)},a.removeInFolder=function(b){a.service.repositoryFolders.splice(b,1)},a.addIncludeFolder=function(){a.service.repositoryFolders||(a.service.repositoryFolders=[]),a.service.repositoryFolders.push({path:""})},a.updateResetObject=function(){a.$parent.setResetServiceTempObject(angular.copy(a.serviceTempObject)),b.getLogger().debug("Updating reset object "+JSON.stringify(a.$parent.resetServiceTempObject))},a.updateResetObject()}]),mainApp.controller("executionWindowDetailsController",["$scope","$state","$location","loggerService","$stateParams","$filter","dialogService","executionWindowService","$anchorScroll","uibDateParser","generalService",function(a,b,c,d,e,f,g,h,i,j,k){a.$parent.isDetailsPage=!0,a.validity={},a.executionWindowID=e.id,a.validFromPopUp={opened:!1},a.expiringOnPopUp={opened:!1},a.validFromOpen=function(){a.validFromPopUp.opened=!0},a.expiringOnOpen=function(){a.expiringOnPopUp.opened=!0},a.dayOfTheWeek=k.getDayOfTheWeek(),a.reloadExecutionWindow=function(){h.getExecutionWindow(a.executionWindowID,function(b){a.executionWindow=b.data,a.validity.validFrom=new Date(a.executionWindow.effectiveFrom),0==a.executionWindow.effectiveUntil?(a.validity.expiringOnOption="never",a.validity.expiringOn=new Date):(a.validity.expiringOnOption="specific",a.validity.expiringOn=new Date(a.executionWindow.effectiveUntil)),a.loadExecutionWindowSlots(),a.copyResetObjects(),d.getLogger().debug(a.executionWindow),a.executionWindow?a.detailsFound=!0:a.detailsFound=!1})},a.copyResetObjects=function(){a.resetExecutionWindow=angular.copy(a.executionWindow),a.resetWeeklySchedules=angular.copy(a.weeklySchedules),a.resetDailySchedules=angular.copy(a.dailySchedules),a.resetValidity=angular.copy(a.validity)},a.loadExecutionWindowSlots=function(){a.executionWindow.executionWindows||(a.executionWindow.executionWindows=[],a.executionWindow.scheduleType="D",a.initializeDailyTimeSlot(),a.initializeWeeklyTimeSlot()),"W"===a.executionWindow.scheduleType?(a.weeklySchedules=[],a.initializeDailyTimeSlot(),angular.forEach(a.executionWindow.executionWindows,function(b,c){angular.forEach(b.executionTimeSlots,function(c,d){var e={sun:!1,mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1};angular.forEach(b.day,function(a,b){e[k.getDayOfTheWeekMap()[a]]=!0});var f=a.parseTimeFromString(c.startTime),g=a.parseTimeFromString(c.endTime);a.weeklySchedules.push({days:e,start:f,end:g,validEndTime:!0})})})):(a.dailySchedules=[],a.initializeWeeklyTimeSlot(),angular.forEach(a.executionWindow.executionWindows,function(b,c){angular.forEach(b.executionTimeSlots,function(b,c){var d=a.parseTimeFromString(b.startTime),e=a.parseTimeFromString(b.endTime);a.dailySchedules.push({start:d,end:e,validEndTime:!0})})}))},a.checkEndTime=function(a){a.start&&a.end&&a.start.getTime()<a.end.getTime()&&(a.validEndTime=!0)},a.getScheduleAsText=function(){var b="";return"D"===a.executionWindow.scheduleType?(b+=f("translate")("daily.label")+" ",angular.forEach(a.dailySchedules,function(c,d){0!=d&&(b+=" "+f("translate")("and.label")+" "),b+=a.parseTimeToString(c.start,!0),b+="-",b+=a.parseTimeToString(c.end,!0)})):angular.forEach(a.weeklySchedules,function(c,d){0!=d&&(b+=" "+f("translate")("and.label")+" ");var e=!1;angular.forEach(c.days,function(a,c){a&&(e=!0,b+=f("translate")(c+".label")+" ")}),e||(b+="<"+f("translate")("week.days.alt")+">"),b+=" ",b+=a.parseTimeToString(c.start,!0),b+="-",b+=a.parseTimeToString(c.end,!0)}),b},a.initializeWeeklyTimeSlot=function(){var b=new Date;b.setHours(0),b.setMinutes(0);var c=new Date;c.setHours(8),c.setMinutes(0),a.weeklySchedules=[{days:{sun:!1,mon:!1,tue:!1,wed:!1,thu:!1,fri:!1,sat:!1},start:b,end:c,validEndTime:!0}]},a.initializeDailyTimeSlot=function(){var b=new Date;b.setHours(0),b.setMinutes(0);var c=new Date;c.setHours(8),c.setMinutes(0),a.dailySchedules=[{start:b,end:c,validEndTime:!0}]},"create"==a.executionWindowID?(a.executionWindow={name:null,scheduleType:"D"},a.validity.validFrom=new Date,a.validity.expiringOn=new Date,a.validity.expiringOnOption="never",a.initializeWeeklyTimeSlot(),a.initializeDailyTimeSlot(),a.detailsFound=!0,a.resetExecutionWindow=angular.copy(a.executionWindow),a.isCreated=!0):(a.reloadExecutionWindow(),a.isCreated=!1),a.backToExecutionWindowList=function(c){a.dataPristine()?b.go("ExecutionWindow"):g.confirm({msg:f("translate")("details.back.confirm"),ok:function(){b.go("ExecutionWindow")}})},a.dataPristine=function(){return angular.equals(a.executionWindow,a.resetExecutionWindow)&&angular.equals(a.dailySchedules,a.resetDailySchedules)&&angular.equals(a.weeklySchedules,a.resetWeeklySchedules)?!!angular.equals(a.validity,a.resetValidity):!1},a.scrollTo=function(a){d.getLogger().info("Scrolling to "+a),c.hash(a),i(),currentTarget=a},a.discardExecutionWindowChanges=function(b){d.getLogger().info("Discarding changes"),a.executionWindow=angular.copy(a.resetExecutionWindow),a.weeklySchedules=angular.copy(a.resetWeeklySchedules),a.dailySchedules=angular.copy(a.resetDailySchedules),a.validity=angular.copy(a.resetValidity),b.$setPristine()},a.saveExecutionWindowChanges=function(c){if(c.$invalid){c.$setDirty();for(var e in c)"$"!=e[0]&&(c[e].$touched=!0)}else{if(0!=a.validity.expiringOn&&a.validity.validFrom.getTime()>a.validity.expiringOn.getTime())return void g.notify({type:"sc-dialog-error",msg:f("translate")("executionWindow.editor.invalid.expiration.validation"),ok:function(){}});if(a.executionWindow.effectiveFrom=a.validity.validFrom.getTime(),"specific"==a.validity.expiringOnOption?a.executionWindow.effectiveUntil=a.validity.expiringOn.getTime():a.executionWindow.effectiveUntil=0,a.executionWindow.executionWindows=[],d.getLogger().debug(a.executionWindow.scheduleType),"D"==a.executionWindow.scheduleType)for(var i=0;i<a.dailySchedules.length;i++){var j=a.dailySchedules[i];if(j.start.getTime()>j.end.getTime())return void(j.validEndTime=!1);var l={displayOrder:i+1,day:["0","1","2","3","4","5","6"],executionTimeSlots:[{displayOrder:1,startTime:a.parseTimeToString(j.start,!1),endTime:a.parseTimeToString(j.end,!1)}]};a.executionWindow.executionWindows.push(l)}else for(var i=0;i<a.weeklySchedules.length;i++){var m=a.weeklySchedules[i];if(m.start.getTime()>m.end.getTime())return void(m.validEndTime=!1);var n=[];angular.forEach(m.days,function(a,b){1==a&&n.push(k.getDayOfTheWeekMap()[b])});var l={displayOrder:i+1,day:n,executionTimeSlots:[{displayOrder:1,startTime:a.parseTimeToString(m.start,!1),endTime:a.parseTimeToString(m.end,!1)}]};a.executionWindow.executionWindows.push(l)}a.isCreated?h.createExecutionWindow(a.executionWindow,function(a){b.go("ExecutionWindow"),d.getLogger().debug(a.message)}):h.modifyExecutionWindow(a.executionWindow,function(b){a.copyResetObjects(),d.getLogger().debug(b.message)}),c.$setPristine()}}}]),mainApp.controller("executionWindowListController",["$scope","$state","loggerService","$stateParams","$filter","sharedService","autoCloseOptionService","executionWindowService","configService","dialogService",function(a,b,c,d,e,f,g,h,i,j){var k=i.configObject.defaultExecutionWindowPageSize;a.$parent.isDetailsPage=!1,a.refreshExecutionWindowList=function(){a.executionWindowPageNumber=1,a.total=0;var b=[];h.getExecutionWindowList(a.executionWindowPageNumber,b,function(b){a.executionWindowList=b.data,a.total=b.totalNoOfRecords,a.numberOfPage=a.total%k==0?a.total/k:a.total/k+1,c.getLogger().debug(b)})},a.refreshExecutionWindowList(),a.loadMore=function(){var b=[];a.executionWindowPageNumber++,c.getLogger().info("Page number "+a.executionWindowPageNumber),h.getExecutionWindowList(a.executionWindowPageNumber,b,function(b){a.executionWindowList=a.executionWindowList.concat(b.data),a.total=b.totalNoOfRecords,a.numberOfPage=a.total%k==0?a.total/k:a.total/k+1,c.getLogger().debug(b)})},a.returnScheduleString=function(a){return h.createScheduleString(a)},a.createNewExecutionWindow=function(){c.getLogger().info("Go to creating new execution window"),b.go("ExecutionWindowDetails",{id:"create"})},a.openExecutionWindow=function(a){c.getLogger().info("Openning execution window set "+a.id),f.data.executionWindowDetails=a,b.go("ExecutionWindowDetails",{id:a.id})},a.deleteExecutionWindow=function(b,d){c.getLogger().info("Deleting execution window set"+b.id),j.confirm({msg:e("translate")("execution.window.del.confirm")+": "+b.name+"?",ok:function(){h.deleteExecutionWindow(b.id,b.modifiedOn,function(b){a.refreshExecutionWindowList(),c.getLogger().debug(b)})}}),d.stopPropagation()};var l=[];a.closeAllOpenOption=function(){l.length>0&&(angular.forEach(l,function(a){c.getLogger().debug("The execution window is = "+JSON.stringify(a)),a.optionOpen&&(a.optionOpen=!1)}),l=[])},a.openOption=function(b,c,d){return angular.isDefined(c)?(b.optionOpen=c,void(c?(a.closeAllOpenOption(),g.close(),g.registerOpen(a,a.closeAllOpenOption),l.push(b)):l=[])):angular.isDefined(b.optionOpen)?b.optionOpen:!1},a.isOptionOpen=function(a){return a.optionOpen?a.optionOpen:!1}}]),mainApp.factory("executionWindowService",["networkService","loggerService","configService","$filter","statusCodeService","generalService",function(a,b,c,d,e,f){var g=c.configObject.defaultExecutionWindowPageSize,h=f.getDayOfTheWeekMap(),i=function(){return[{label:d("translate")("executionWindow.sortby.name"),field:"name"}]},j=function(a){for(var b="",c=a.executionWindows,e=0;e<c.length;e++){e>0&&(b+=", ");var f=c[e],g=f.day;if("D"===a.scheduleType)b+=d("translate")("daily.label");else for(var i=0;i<g.length;i++)b+=d("translate")(h[g[i]]+".label")+" ";b+=" "+f.executionTimeSlots[0].startTime.slice(0,2)+":"+f.executionTimeSlots[0].startTime.slice(2,4)+"-"+f.executionTimeSlots[0].endTime.slice(0,2)+":"+f.executionTimeSlots[0].endTime.slice(2,4)}return b},k=function(d,f,h){b.getLogger().info("Get execution window list of type  with page number "+d+" and page size "+g);var i={sortFields:f,pageNo:d,pageSize:g};a.post(c.getUrl("executionWindow.list"),i,function(a){e.list("ExecutionWindow",h,a)})},l=function(d,f){b.getLogger().info("Get execution window  with ID "+d),b.getLogger().debug(c.getUrl("executionWindow.get")+d),a.get(c.getUrl("executionWindow.get")+d,function(a){e.get("ExecutionWindow",f,a)})},m=function(d,f){b.getLogger().info("Modifying execution window "+d.id);var g=d;a.put(c.getUrl("executionWindow.modify"),g,function(a){e.modify("ExecutionWindow",f,a)})},n=function(d,f,g){b.getLogger().info("Deleting execution window "+d),a.del(c.getUrl("executionWindow.delete")+d+"/"+f,function(a){e.del("ExecutionWindow",g,a)})},o=function(d,f){b.getLogger().info("Creating execution window with details "+d);var g=d;a.post(c.getUrl("executionWindow.add"),g,function(a){e.create("ExecutionWindow",f,a)})};return{getExecutionWindowList:k,getExecutionWindow:l,modifyExecutionWindow:m,deleteExecutionWindow:n,getSortFields:i,createScheduleString:j,createExecutionWindow:o}}]),mainApp.controller("generalSettingsController",["$scope","$state","loggerService","$filter","generalSettingsService","configService",function(a,b,c,d,e,f){a.$parent.isDetailsPage=!1,a.isDirty={},a.refreshGeneralSettings=function(){e.getSettingList(function(b){a.settingList=b.data,a.resetSettingList=angular.copy(a.settingList),c.getLogger().debug(b)})},a.refreshGeneralSettings(),a.modifyGeneralSetting=function(b,c){return c.$invalid?(c.$dirty=!0,void(c.$touched=!0)):void e.modifySetting(b,function(c){
a.isDirty[b.id]=!1,a.resetSettingList=angular.copy(a.settingList)})},a.onSettingChange=function(b){a.isDirty[b]=!0},a.resetSettings=function(){a.settingList=angular.copy(a.resetSettingList),a.isDirty={}},a.saveAll=function(b){if(b.$invalid){b.$setDirty();for(var c in b)"$"!=c[0]&&(b[c].$touched=!0,b[c].$dirty=!0)}else{var d=[];a.settingList&&angular.forEach(a.settingList,function(a,b){a.systemConfigs&&angular.forEach(a.systemConfigs,function(a,b){d.push(a)})}),e.modifyAllSettings(d,function(b){a.resetSettingList=angular.copy(a.settingList),a.isDirty={}})}}}]),mainApp.factory("generalSettingsService",["networkService","loggerService","configService","$filter","statusCodeService",function(a,b,c,d,e){var f=function(d){b.getLogger().info("Get general settings list"),a.post(c.getUrl("generalSettings.list"),null,function(a){e.list("General Settings",d,a)})},g=function(d,f){b.getLogger().info("Get setting with ID "+d),a.get(c.getUrl("generalSettings.get")+d,function(a){e.get("General Settings",f,a)})},h=function(d,f){b.getLogger().info("Modifying setting "+d.id);var g=d;a.put(c.getUrl("generalSettings.modify"),g,function(a){e.modify("General Settings",f,a)})},i=function(d,f){b.getLogger().info("Modifying all settings");var g=d;a.put(c.getUrl("generalSettings.modifyAll"),g,function(a){e.modify("General Settings",f,a)})};return{getSettingList:f,getSetting:g,modifySetting:h,modifyAllSettings:i}}]),mainApp.controller("jmsDetailsController",["$scope","$state","$location","loggerService","$window","$stateParams","$filter","dialogService","jmsService","$anchorScroll",function(a,b,c,d,e,f,g,h,i,j){a.$parent.isDetailsPage=!0,a.jmsID=f.id,a.jmsTypes=["Q","T"],a.reloadJMS=function(){i.getJMS(a.jmsID,function(b){a.jms=b.data,a.resetJMS=angular.copy(a.jms),d.getLogger().debug(a.jms),a.jms?a.detailsFound=!0:a.detailsFound=!1})},"create"==a.jmsID?(a.jms={displayName:null,description:"JMS for sending document extraction information to extractor.",type:"Q",providerURL:null,initialContextFactory:null,URLPackagePrefix:null,connectionFactor:null,serviceName:null,connectionRetryInterval:5},a.detailsFound=!0,a.resetJMS=angular.copy(a.jms),a.isCreated=!0):(a.reloadJMS(),a.isCreated=!1),a.backToJMSList=function(c){angular.equals(a.jms,a.resetJMS)?b.go("JMS"):h.confirm({msg:g("translate")("details.back.confirm"),ok:function(){b.go("JMS")}})},a.scrollTo=function(a){c.hash(a),j(),currentTarget=a},a.discardJMSChanges=function(b){d.getLogger().info("Discarding changes"),a.jms=angular.copy(a.resetJMS),b.$setPristine()},a.changeJMSType=function(b){a.jms.type=b},a.saveJMSChanges=function(c){if(c.$invalid){c.$setDirty();for(var e in c)"$"!=e[0]&&(c[e].$touched=!0)}else a.isCreated?i.createJMS(a.jms,function(a){b.go("JMS"),d.getLogger().debug(a.message)}):i.modifyJMS(a.jms,function(b){a.resetJMS=angular.copy(a.jms),d.getLogger().debug(b.message)}),c.$setPristine()}}]),mainApp.controller("jmsListController",["$scope","$state","loggerService","$stateParams","$filter","autoCloseOptionService","jmsService","configService","dialogService",function(a,b,c,d,e,f,g,h,i){var j=h.configObject.defaultJMSPageSize;a.$parent.isDetailsPage=!1,a.refreshJMSList=function(){a.jmsPageNumber=1,a.total=0;var b=[];g.getJMSList(a.jmsPageNumber,b,function(b){a.jmsList=b.data,a.total=b.totalNoOfRecords,a.numberOfPage=a.total%j==0?a.total/j:a.total/j+1,c.getLogger().debug(JSON.stringify(b))})},a.refreshJMSList(),a.loadMore=function(){var b=[];a.jmsPageNumber++,c.getLogger().info("Page number "+a.jmsPageNumber),g.getJMSList(a.jmsPageNumber,b,function(b){a.jmsList=a.jmsList.concat(b.data),a.total=b.totalNoOfRecords,a.numberOfPage=a.total%j==0?a.total/j:a.total/j+1,c.getLogger().debug(JSON.stringify(b))})},a.createNewJMS=function(){c.getLogger().info("Go to creating new jms"),b.go("JMSDetails",{id:"create"})},a.openJMS=function(a){c.getLogger().info("Openning jms "+a.id),b.go("JMSDetails",{id:a.id})},a.deleteJMS=function(b,d){c.getLogger().info("Deleting jms "+b.id),i.confirm({msg:e("translate")("jms.del.confirm")+": "+b.displayName+"?",ok:function(){g.deleteJMS(b.id,b.modifiedOn,function(b){a.refreshJMSList(),c.getLogger().debug(JSON.stringify(b))})}}),d.stopPropagation()};var k=[];a.closeAllOpenOption=function(){k.length>0&&(angular.forEach(k,function(a){c.getLogger().debug("The JMS is = "+JSON.stringify(a)),a.optionOpen&&(a.optionOpen=!1)}),k=[])},a.openOption=function(b,c,d){return angular.isDefined(c)?(b.optionOpen=c,void(c?(a.closeAllOpenOption(),f.close(),f.registerOpen(a,a.closeAllOpenOption),k.push(b)):k=[])):angular.isDefined(b.optionOpen)?b.optionOpen:!1},a.isOptionOpen=function(a){return a.optionOpen?a.optionOpen:!1}}]),mainApp.factory("jmsService",["networkService","loggerService","configService","$filter","statusCodeService",function(a,b,c,d,e){var f=c.configObject.defaultJMSPageSize,g=function(){return[{label:d("translate")("jms.sort.by.name"),field:"displayName"}]},h=function(d,g,h){b.getLogger().info("Get jms list of type  with page number "+d+" and page size "+f);var i={sortFields:g,pageNo:d,pageSize:f};a.post(c.getUrl("jms.list"),i,function(a){e.list("JMSProfile",h,a)})},i=function(d,f){b.getLogger().info("Creating jms with details "+d);var g=d;a.post(c.getUrl("jms.add"),g,function(a){e.create("JMSProfile",f,a)})},j=function(d,f){b.getLogger().info("Get jms with ID "+d),b.getLogger().debug(c.getUrl("jms.get")+d),a.get(c.getUrl("jms.get")+d,function(a){e.get("JMSProfile",f,a)})},k=function(d,f){b.getLogger().info("Modifying jms "+d.id);var g=d;a.put(c.getUrl("jms.modify"),g,function(a){e.modify("JMSProfile",f,a)})},l=function(d,f,g){b.getLogger().info("Deleting JMS profile "+d),a.del(c.getUrl("jms.delete")+d+"/"+f,function(a){b.getLogger().debug("jms.delete call back"),e.del("JMSProfile",g,a)})};return{getJMSList:h,getJMS:j,modifyJMS:k,deleteJMS:l,getSortFields:g,createJMS:i}}]),mainApp.controller("licenseController",["$scope","loggerService","$filter","summaryService",function(a,b,c,d){a.$parent.isDetailsPage=!1,a.getLicenseInformation=function(){d.getSummary("document",function(b){a.documentSummary=b.data,a.licenseFound=!0,a.loadLicenseInfo()})},a.getLicenseInformation(),a.loadLicenseInfo=function(){for(var c=0;c<a.documentSummary.length;c++)if(a.documentSummary[c].value){if("Data size"==a.documentSummary[c].code){a.dataSize=Number(a.documentSummary[c].value);continue}if("License expiry date"==a.documentSummary[c].code){a.expiryDate=new Date(a.documentSummary[c].value),b.getLogger().debug(JSON.stringify(a.expiryDate));continue}if("Used size"==a.documentSummary[c].code){a.usedSize=Number(a.documentSummary[c].value)/1024/1024/1024,a.usedSize=a.usedSize.toFixed(2),b.getLogger().debug(a.usedSize);continue}}return void 0==a.expiryDate||null==a.expiryDate||void 0==a.dataSize||void 0==a.usedSize?void(a.licenseFound=!1):void 0},a.getLicenseRemainingDays=function(){var b=864e5,c=new Date;return a.expiryDate?Math.round((a.expiryDate-c.getTime())/b):0},a.getRemaining=function(){return(a.dataSize-a.usedSize).toFixed(2)},a.getRemainingClass=function(){return"success"===a.getUsedSizeStyle()?"sc-green":"danger"===a.getUsedSizeStyle()?"sc-red":"warning"===a.getUsedSizeStyle()?"sc-orange":void 0},a.getExpiryClass=function(){return a.getLicenseRemainingDays()>=180?"sc-green":a.getLicenseRemainingDays()<=0?"sc-red":a.getLicenseRemainingDays()<180?"sc-orange":void 0},a.getUsedSizeStyle=function(){return a.usedSize/a.dataSize<.5?"success":a.usedSize/a.dataSize<.75?"warning":a.usedSize/a.dataSize<=1?"danger":a.usedSize/a.dataSize>1?"danger":void 0}}]),mainApp.controller("pluginDetailsController",["$scope","$state","$location","loggerService","$stateParams","$filter","dialogService","pluginService","generalService","$anchorScroll",function(a,b,c,d,e,f,g,h,i,j){a.$parent.isDetailsPage=!0,a.pluginsID=e.id,a.changeBooleanValue=function(b,c){d.getLogger().info("Boolean value is now = "+b),d.getLogger().info("Parameter is "+a.plugins.params[c].label),a.plugins.params[c].value=b,d.getLogger().debug(JSON.stringify(a.plugins.params))},a.dateValuePopup={opened:!1},a.dateValueOpened=function(){a.dateValuePopup.opened=!0},a.reloadPlugin=function(){h.getPlugin(a.pluginsID,function(b){a.plugins=b.data,a.resetPlugin=angular.copy(a.plugins),d.getLogger().debug(JSON.stringify(a.plugins)),a.plugins?a.detailsFound=!0:a.detailsFound=!1})},a.reloadPlugin(),a.backToPluginsList=function(c){angular.equals(a.plugins,a.resetPlugin)?b.go("Plugins"):g.confirm({msg:f("translate")("details.back.confirm"),ok:function(){b.go("Plugins")}})},a.scrollTo=function(a){c.hash(a),j(),currentTarget=a},a.discardPluginChanges=function(b){d.getLogger().log("Discarding changes"),a.plugins=angular.copy(a.resetPlugin),b.$setPristine()},a.savePluginChanges=function(b){if(b.$invalid){b.$setDirty();for(var c in b)"$"!=c[0]&&(b[c].$touched=!0,b[c].$dirty=!0)}else h.modifyPlugin(a.plugins,function(b){a.resetPlugin=angular.copy(a.plugins),d.getLogger().log(b.message)}),b.$setPristine()},a.booleanValues=i.getBooleanValuesArray(),d.getLogger().log("scope.booleanvalues = "+JSON.stringify(a.booleanValues))}]),mainApp.controller("pluginListController",["$scope","$state","loggerService","$stateParams","$filter","sharedService","autoCloseOptionService","configService","pluginService",function(a,b,c,d,e,f,g,h,i){var j=h.configObject.defaultPluginsPageSize;a.$parent.isDetailsPage=!1,a.refreshPluginsList=function(){a.pluginsPageNumber=1,a.total=0;var b=[{field:"displayName",order:"asc"}];i.getPluginList(a.pluginsPageNumber,b,function(b){a.pluginsList=b.data,a.total=b.totalNoOfRecords,a.numberOfPage=a.total%j==0?a.total/j:a.total/j+1,c.getLogger().debug(JSON.stringify(b))})},a.refreshPluginsList(),a.loadMore=function(){var b=[];a.pluginsPageNumber++,c.getLogger().log("Page number "+a.pluginsPageNumber),i.getPluginList(a.pluginsPageNumber,b,function(b){a.pluginsList=a.pluginsList.concat(b.data),a.total=b.totalNoOfRecords,a.numberOfPage=a.total%j==0?a.total/j:a.total/j+1,c.getLogger().debug(JSON.stringify(b))})},a.openOption=function(b,c,d){return angular.isDefined(c)?(b.optionOpen=c,void(c?(a.closeAllOpenOption(),g.close(),g.registerOpen(a,a.closeAllOpenOption),k.push(b)):k=[])):angular.isDefined(b.optionOpen)?b.optionOpen:!1},a.openPlugin=function(a){c.getLogger().info("Opening plugin "+a.id),f.data.pluginDetails=a,b.go("PluginDetails",{id:a.id})},a.isOptionOpen=function(a){return a.optionOpen?a.optionOpen:!1},a.getDateFormat=function(){return c.getLogger().log(h.configObject["date.format"]),h.configObject["date.format"]};var k=[];a.closeAllOpenOption=function(){k.length>0&&(angular.forEach(k,function(a){c.getLogger().log("The plugins object = "+JSON.stringify(a)),a.optionOpen&&(a.optionOpen=!1)}),k=[])}}]),mainApp.factory("pluginService",["networkService","loggerService","configService","$filter","statusCodeService","collectionService",function(a,b,c,d,e,f){var g=c.configObject.defaultPluginsPageSize,h=function(){return[{label:d("translate")("plugins.sort.by.name"),field:"name",order:"asc"}]},i=function(d,f,h){b.getLogger().info("Get plugin list of type  with page number "+d+" and page size "+g);var i={sortFields:f,pageNo:d,pageSize:g};a.post(c.getUrl("plugins.list"),i,function(a){e.list("Plugins",h,a)})},j=function(d,f){b.getLogger().info("Get plugin with ID "+d),b.getLogger().debug(c.getUrl("plugins.get")+d),a.get(c.getUrl("plugins.get")+d,function(a){e.get("Plugins",f,a)})},k=function(d,f){b.getLogger().info("Modifying plugin "+d.id);var g=d;a.put(c.getUrl("plugins.modify"),g,function(a){e.modify("Plugins",f,a)})};return{getPluginList:i,getPlugin:j,modifyPlugin:k,getSortFields:h}}]),mainApp.controller("appController",["$scope","networkService","configService","loggerService","$location","$templateCache","sharedService","$filter","$state",function(a,b,c,d,e,f,g,h,i){c.setConfig(MainAppConfig),a.tabs=[{title:"TAB.Overview",url:"overview",finalUrl:"Overview",icon:"fa-bar-chart"},{title:"TAB.Rules",url:"rules",finalUrl:"Rules",icon:"fa-file-text-o"},{title:"TAB.SCServices",url:"scservices",icon:"fa-qrcode",children:[{title:"TAB.SCServices.Watchers",url:'scservices({type:"watcher"})',finalUrl:"Services/watcher",icon:"fa-eye"},{title:"TAB.SCServices.Extractors",url:'scservices({type:"extractor"})',finalUrl:"Services/extractor",icon:"fa-external-link"},{title:"TAB.SCServices.RuleEngine",url:'scservices({type:"ruleEngine"})',finalUrl:"Services/ruleEngine",icon:"fa-tasks"}]},{title:"TAB.IndexDatabaseQuery",url:'indexDatabaseQuery({id:"custom"})',finalUrl:"IndexDatabaseQuery",icon:"fa-database"},{title:"TAB.Settings",url:"settings",icon:"fa-gears",children:[{title:"TAB.Settings.General",url:"GeneralSettings",finalUrl:"Settings/General",icon:"fa-gear"},{title:"TAB.Settings.ExecutionWindow",url:"ExecutionWindow",finalUrl:"Settings/ExecutionWindow",icon:"fa-toggle-right"},{title:"TAB.Settings.Plugins",url:"Plugins",finalUrl:"Settings/Plugins",icon:"fa-puzzle-piece"},{title:"TAB.Settings.JMS",url:"JMS",finalUrl:"Settings/MessagingService",icon:"fa-inbox"},{title:"TAB.Settings.License",url:"License",finalUrl:"Settings/License",icon:"fa-certificate"}]}];var j=e.url();0==j.indexOf("/")&&(j=j.substring(1)),"/"==j[j.length-1]&&(j=j.substring(0,j.length-1));for(var k=function(b,c){c.children?(c.expanded=!1,angular.forEach(c.children,function(a){k(c,a)&&(c.expanded=!0)})):(c.finalUrl&&0==j.indexOf(c.finalUrl)||c.url&&0==j.indexOf(c.url))&&(b&&(b.expanded=!0),a.currentTab=c.url)},l=0;l<a.tabs.length;l++)k(void 0,a.tabs[l]);a.onClickTab=function(b){a.currentTab=b.url},a.isActiveTab=function(b){return a.currentTab==b},a.$on("$locationChangeStart",function(b,c){j=c.substring(c.indexOf("#")+2),angular.forEach(a.tabs,function(a){k(void 0,a)})}),a.isDetailsPage=!1,a.getMenuClass=function(){return a.isDetailsPage?"hide":"col-xs-4 col-sm-4 col-md-4"},a.getMainContentClass=function(){return a.isDetailsPage?"col-xs-12 col-sm-12 col-md-12":"col-xs-8 col-sm-8 col-md-8"},a.getTooltipMessage=function(a){var b="";return a?a.$valid?"":(a.$error.minlength&&(b+=h("translate")("component.minlength.validation")+"; "),a.$error.maxlength&&(b+=h("translate")("component.maxlength.validation")+"; "),a.$error.email&&(b+=h("translate")("component.email.validation")+"; "),a.$error.required&&(b+=h("translate")("component.required.validation")+"; "),b=b.slice(0,b.length-2)):""},a.parseTimeFromString=function(a){if(!a)return"";var b=new Date;return b.setHours(parseInt(a.slice(0,2))),b.setMinutes(parseInt(a.slice(2,4))),b},a.parseTimeToString=function(a,b){if(!a)return"";var c=a.getHours(),d=c.toString(),e=a.getMinutes(),f=e.toString();return 10>c&&(d="0"+d),10>e&&(f="0"+f),b?d+":"+f:d+f},a.abs=function(a){return Math.abs(a)},a.doughnutChartOption={cutoutPercentage:85,animationEasing:"easeOutQuad"},a.pieChartOption={animationEasing:"easeOutQuad"},a.getDateFormat=function(){return d.getLogger().debug("The date format is  = "+c.configObject["date.format"]),c.configObject["date.format"]},a.serviceChartColors=["#5CB85C","#F0AD4E","#D9534F","#222222","#FDB45C","#949FB1","#4D5360"],a.processChartColors=["#1F4392","#444444"],a.getDateFromLong=function(a){return new Date(a)},a.goHome=function(){d.getLogger().debug("AppController.js : Inside goHome()"),i.go("overview")},d.getLogger().debug("Log level is "+c.configObject.logLevel)}]),angular.module("mainApp").directive("friendlyDate",["$filter",function(a){return{scope:{date:"@",prefix:"@",fullFormat:"@",shortFormat:"@",titleClass:"@",contentClass:"@",dateType:"@"},template:'<p class="{{titleClass}}">{{title}}</p>     <p class="{{contentClass}}">{{content}}</p>',link:function(b,c,d){var e=b.prefix,f=null;f=new Date(parseInt(b.date));var g=new Date,h="",i="";if(e&&(h=e),g.getFullYear()==f.getFullYear()&&g.getMonth()==f.getMonth()&&g.getDate()==f.getDate()){var j=g.getTime(),k=f.getTime();if(j-k>36e5){var l=parseInt((j-k)/36e5);i=l+" "+(1==l?"hour":"hours")+" ago"}else if(j-k>6e4){var m=parseInt((j-k)/6e4);i=m+" "+(1==m?"min":"mins")+" ago"}else i="a moment ago"}else{var n=new Date;n.setDate(g.getDate()-1),i=g.getFullYear()==f.getFullYear()&&g.getMonth()==f.getMonth()&&g.getDate()==f.getDate()+1?"yesterday, "+a("date")(f,b.shortFormat):a("date")(f,b.fullFormat)}b.title=h,b.content=i}}}]),angular.module("mainApp").directive("httpLoader",["$http",function(a){return{restrict:"A",link:function(b,c,d){b.isLoading=function(){return a.pendingRequests.length>0},b.$watch(b.isLoading,function(a){a?c.removeClass("ng-hide"):c.addClass("ng-hide")})}}}]),angular.module("mainApp").directive("multiParam",function(){return{require:"^form",restrict:"E",scope:{inputTags:"=paramlist",autocomplete:"=autocomplete"},link:function(a,b,c,d){return a.form=d,a.defaultWidth=200,a.tagText="",a.placeholder=c.placeholder,a.inputType=c.inputType,a.inputRequired=c.inputRequired,a.name=c.name,a.invalidInput=!1,a.duplicateInput=!1,a.emailPattern="^[_A-Za-z0-9-]+(\\.[_A-Za-z0-9-]+)*@[A-Za-z0-9]+(\\.[A-Za-z0-9]+)*(\\.[A-Za-z]{2,})$",a.resetPlaceholder=angular.copy(a.placeholder),a.inputColor="black",a.duplicateMap={},a.autocomplete&&(a.autocompleteFocus=function(a,c){return $(b).find("input").val(c.item.value),!1},a.autocompleteSelect=function(b,c){return a.$apply("tagText='"+c.item.value+"'"),a.$apply("addTag()"),!1},$(b).find("input").autocomplete({minLength:0,source:function(b,c){var d;return c(function(){var c,e,f,g;for(f=a.autocomplete,g=[],c=0,e=f.length;e>c&&!window.CP.shouldStopExecution(1);c++)d=f[c],-1!==d.toLowerCase().indexOf(b.term.toLowerCase())&&g.push(d);return window.CP.exitedLoop(1),g}())},focus:function(b){return function(b,c){return a.autocompleteFocus(b,c)}}(this),select:function(b){return function(b,c){return a.autocompleteSelect(b,c)}}(this)})),a.tagArray=function(){if(a.tagText&&0!==a.tagText.length||(a.invalidInput=!1,a.duplicateInput=!1),void 0===a.inputTags)return a.inputWidth="100%",[];if(a.inputTags.length>0){if(a.inputWidth=200,a.placeholder="",0==Object.keys(a.duplicateMap).length)for(var b=0;b<a.inputTags.length;b++)a.duplicateMap[a.inputTags[b].value]=!0}else a.inputWidth="100%",a.placeholder=angular.copy(a.resetPlaceholder);return a.inputTags},a.addTag=function(){console.debug("Adding tag");var b;if(!a.tagText||0===a.tagText.length)return void console.debug("Tag length = 0. Skip");if(b=a.tagArray(),a.duplicateMap[a.tagText])return a.duplicateInput=!0,void console.debug("Duplicate input!");if(a.duplicateInput=!1,"Email"===a.inputType){if(!a.tagText.match(a.emailPattern))return a.invalidInput=!0,void console.debug("Invalid email");a.invalidInput=!1}if(isNaN(a.tagText)){if("Number"===a.inputType||"Integer"===a.inputType)return a.invalidInput=!0,void console.debug("Invalid number")}else if("Integer"===a.inputType&&Number(a.tagText)%1!=0)return a.invalidInput=!0,void console.debug("Invalid integer");return b.push({value:a.tagText}),a.duplicateMap[a.tagText]=!0,a.inputColor="black",console.debug(a.duplicateMap),a.tagText=""},a.deleteTag=function(b){console.debug("Deleting tag");var c;return c=a.tagArray(),c.length>0&&0===a.tagText.length&&void 0===b?(a.duplicateMap[c[c.length-1].value]=!1,c.pop()):void 0!==b&&(a.duplicateMap[c[b].value]=!1,c.splice(b,1)),console.debug(a.duplicateMap),c},a.$watch("tagText",function(b,c){a.inputColor="black";var d;return b!==c||void 0!==b?(d=$("<span>"+b+"</span>").appendTo("body"),a.inputWidth=d.width()+5,a.inputWidth<a.defaultWidth&&(a.inputWidth=a.defaultWidth),d.remove()):void 0}),b.bind("keydown",function(b){var c;return c=b.which,9!==c&&13!==c||b.preventDefault(),8===c?a.$apply("deleteTag()"):void 0}),b.bind("keyup",function(b){var c;return c=b.which,9===c||13===c?(b.preventDefault(),a.$apply("addTag()")):void 0})},templateUrl:"ui/app/templates/multiParam.html"}}),mainApp.factory("autoCloseOptionService",["$document","$rootScope",function(a,b){var c=null,d=null,e=function(b,e){c||setTimeout(function(){a.on("click",g)},5),c=b,d=e},f=function(){c=null,a.off("click",g)},g=function(){c&&(d(),b.$$phase||c.$apply(),c=null,a.off("click",g))};return{registerOpen:e,close:f}}]),mainApp.factory("collectionService",["$http","networkService","loggerService","configService","$filter","statusCodeService",function(a,b,c,d,e,f){var g=function(a,e){c.getLogger().info("Get collection "+a),b.get(d.getUrl("collection.get")+a,function(b){f.getCollection(a,e,b)})};return{getCollection:g}}]),mainApp.factory("configService",["networkService","$location","$filter",function(a,b,c){this.configObject={};var d=function(){a.get("../config/config.json",configCallBack)},e=function(b){this.configObject=b,b.isOnline||a.onlyGet(!0)},f=function(a){var c=this.configObject.isOnline?this.configObject.url.online:this.configObject.url.offline;b.protocol()+"://"+b.host()+":"+b.port()+"/"+c.projectName+"/rest/v1/";return"rest/v1/"+c.map[a]},g=function(){var a=[{label:c("translate")("sort.order.asc"),value:"asc"},{label:c("translate")("sort.order.desc"),value:"desc"}];return a};return{configObject:this.configObject,getConfig:d,setConfig:e,getUrl:f,getSortOrders:g}}]),mainApp.factory("dialogService",["$uibModal",function(a){var b=function(b){var c=b.title,d=b.msg,e=b.ok,f=b.cancel;a.open({animation:!0,templateUrl:"ui/app/templates/dialog-confirm.html",controller:["$uibModalInstance","$scope",function(a,b){b.title=c,b.msg=d,b.ok=function(){a.dismiss("cancel"),e&&e()},b.cancel=function(){a.dismiss("cancel"),f&&f()}}]})},c=function(b){var c=b.type,d=b.title,e=b.msg,f=b.ok;a.open({animation:!0,templateUrl:"ui/app/templates/dialog-notify.html",controller:["$uibModalInstance","$scope",function(a,b){b.type=c,b.title=d,b.msg=e,b.ok=function(){a.dismiss("cancel"),f&&f()}}]})};return{confirm:b,notify:c}}]),mainApp.factory("generalService",["configService",function(a){var b=[!0,!1],c=function(a){var b,c=a!==a;return b=c||"function"!=typeof Array.prototype.indexOf?function(a){var b=-1,d=-1;for(b=0;b<this.length;b++){var e=this[b];if(c&&e!==e||e===a){d=b;break}}return d}:Array.prototype.indexOf,b.call(this,a)>-1},d=function(a,b){var c;for(c=0;c<a.length;c++)if(loggerService.getLogger().debug("List Object Id is = "+a[c].id),a[c].id==b.id)return!0;return!1},e=function(a,b){return 0===a.lastIndexOf(b,0)},f=function(a,b){return 0===a.lastIndexOf(b,0)},g={0:"sun",1:"mon",2:"tue",3:"wed",4:"thu",5:"fri",6:"sat",sun:"0",mon:"1",tue:"2",wed:"3",thu:"4",fri:"5",sat:"6"},h=function(){var a=["sun","mon","tue","wed","thu","fri","sat"];return a},i=function(){for(var a=[],b=1;31>b;b++)a.push(b);return a.push("L"),a},j=function(){return g},k=function(){return b};return{contains:c,containsObject:d,isSubFolder:e,getBooleanValuesArray:k,getDayOfTheWeek:h,getDayOfTheMonth:i,getDayOfTheWeekMap:j,stringStartWith:f}}]),mainApp.factory("loggerService",["configService",function(a){var b=function(b,c){a.configObject&&c<=a.configObject.logLevel&&loggerService.getLogger().log(b)},c=null,d=function(){if(!c){var b={log:function(){}};c=a.configObject&&1<=a.configObject.logLevel?window.console:b}return c};return{log:b,getLogger:d}}]),mainApp.factory("networkService",["$http","$filter","dialogService",function(a,b,c){var d=function(a){switch(console.error("Status error is "+a.status),a.status){case 404:loggerService.getLogger().info("Not found"),c.notify({type:"sc-dialog-error",msg:b("translate")("ERROR.400"),ok:function(){}});break;case 500:loggerService.getLogger().info("Internal"),c.notify({type:"sc-dialog-error",msg:b("translate")("ERROR.500"),ok:function(){}});break;default:loggerService.getLogger().info("Unknown"),c.notify({type:"sc-dialog-error",msg:b("translate")("ERROR.unknown")+":"+a.statusText,ok:function(){}})}},e=function(b,c){a({method:"GET",url:b}).then(function(a){c&&c(a.data)},d)},f=function(b,c,e){a({method:"POST",data:c,url:b}).then(function(a){e&&e(a.data)},d)},g=function(b,c,e,f){var g={method:"DELETE",headers:{},data:c,url:b};f&&(g.headers["Content-Type"]=f),a(g).then(function(a){e&&e(a.data)},d)},h=function(b,c){a({method:"DELETE",url:b}).then(function(a){c&&c(a.data)},d)},i=function(b,c,e){a({method:"PUT",data:c,url:b}).then(function(a){e&&e(a.data)},d)};return{get:e,post:f,put:i,del:h,delWithData:g}}]),mainApp.factory("sharedService",function(){var a={};return a.data={},a}),mainApp.factory("statusCodeService",["loggerService","configService","$filter","dialogService",function(a,b,c,d){var e=function(){d.notify({type:"sc-dialog-error",msg:c("translate")("status.code.missing"),ok:function(){}})},f=function(b,f,g){a.getLogger().info("Process response for creating "+b);var h=g.statusCode;if(a.getLogger().info("Status Code is "+h),!h)return void e();switch(h){case"1000":f&&f(g),d.notify({type:"sc-dialog-success",msg:c("translate")("create.saved.notify"),ok:function(){}});break;case"5004":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.5004"),ok:function(){}});break;case"6000":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}},g=function(b,f,g){a.getLogger().info("Process response for executing "+b);var h=g.statusCode;if(a.getLogger().info("Status Code is "+h),!h)return void e();switch(h){case"1000":f&&f(g),d.notify({type:"sc-dialog-success",msg:c("translate")("execute.issued.notify"),ok:function(){}});break;case"6000":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}},h=function(b,f,g){a.getLogger().info("Process response for modifying "+b);var h=g.statusCode;if(a.getLogger().info("Status Code is "+h),!h)return void e();switch(h){case"1001":d.notify({type:"sc-dialog-success",msg:c("translate")("modify.saved.notify"),ok:function(){}}),f&&f(g);break;case"5002":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.5002"),ok:function(){}});break;case"5004":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.5004"),ok:function(){}});break;case"6000":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}},i=function(b,f,g){a.getLogger().info("Process response for getting "+b);var h=g.statusCode;if(a.getLogger().info("Status Code is "+h),!h)return void e();switch(h){case"1003":f&&f(g);break;case"5001":f&&f(g);break;case"6000":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}},j=function(b,f,g){a.getLogger().log("Process response for deleting "+b);var h=g.statusCode;if(a.getLogger().info("Status Code is "+h),!h)return void e();switch(h){case"1002":d.notify({type:"sc-dialog-success",msg:c("translate")("delete.deleted.notify"),ok:function(){}}),f&&f(g);break;case"5005":d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.5005"),ok:function(){}});break;case"6000":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}},k=function(b,f,g){a.getLogger().info("Process response for listing "+b);var h=g.statusCode;if(a.getLogger().info("Status Code is "+h),!h)return void e();switch(h){case"1004":f&&f(g);break;case"5000":f&&f(g);break;case"6000":a.getLogger().error("Server error "+g.message),d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}},l=function(b,f,g){a.getLogger().info("Process response for getting collection of "+b);var h=g.statusCode;if(!h)return void e();switch(h){case"1004":f&&f(g);break;case"4006":a.getLogger().error("Get collection: "+g.message);break;case"5000":a.getLogger().info("No data found"),f&&f(g);break;case"6000":d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}},m=function(b,f,g){a.getLogger().info("Process response for getting summary of "+b);var h=g.statusCode;if(!h)return void e();switch(h){case"1004":f&&f(g);break;case"5000":a.getLogger().info("No data found"),f&&f(g);break;case"6000":d.notify({type:"sc-dialog-error",msg:c("translate")("ERROR.6000"),ok:function(){}});break;default:a.getLogger().info(g.message),d.notify({type:"sc-dialog-warning",msg:g.message,ok:function(){}})}};return{create:f,get:i,modify:h,del:j,list:k,getCollection:l,execute:g,getSummary:m}}]),mainApp.factory("summaryService",["networkService","loggerService","configService","statusCodeService",function(a,b,c,d){var e=function(e,f){b.getLogger().info("Get summary of "+e);var g={};a.post(c.getUrl("summary.get")+e+"Summary",g,function(a){d.getCollection(e,f,a)})};return{getSummary:e}}]);